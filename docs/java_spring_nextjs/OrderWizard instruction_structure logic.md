# Розширена документація Order Wizard для хімчистки

## Огляд та архітектура

Order Wizard — це покроковий інтерфейс для оформлення замовлень у хімчистці з інтегрованою системою розрахунку цін, управлінням клієнтами та формуванням квитанцій. Архітектура "каскадного візарда" дозволяє циклічно додавати предмети до замовлення та формувати детальну документацію.

## Структура Order Wizard (4 основні етапи)

### Етап 1: Клієнт та базова інформація замовлення

#### 1.1. Вибір або створення клієнта
- **Форма пошуку існуючого клієнта**
  - Пошук за прізвищем, телефоном
  - Відображення списку знайдених клієнтів
  - Можливість вибрати клієнта зі списку

- **Форма нового клієнта**
  - Прізвище та ім'я (обов'язкове)
  - Телефон (обов'язкове)
  - Email
  - Адреса
  - Способи зв'язку (мультивибір):
    - Номер телефону
    - SMS
    - Viber
  - Джерело інформації про хімчистку:
    - Інстаграм
    - Google
    - Рекомендації
    - Інше (з полем для уточнення)

#### 1.2. Базова інформація замовлення
- **Номер квитанції** (генерується автоматично)
- **Унікальна мітка** (вводиться вручну або сканується)
- **Пункт прийому замовлення** (вибір філії)
- **Дата створення замовлення** (автоматично)

### Етап 2: Менеджер предметів (циклічний процес)

#### 2.0. Головний екран менеджера предметів
- **Таблиця доданих предметів**:
  - Найменування предмета
  - Категорія
  - Кількість (шт/кг)
  - Матеріал
  - Колір
  - Сума
  - Кнопки дій (Редагувати, Видалити)
- **Кнопка "Додати предмет"** (запускає підвізард)
- **Лічильник загальної вартості** (оновлюється динамічно)
- **Кнопка "Продовжити до наступного етапу"** (запускає підетап)

#### Підетап 2.1: Основна інформація про предмет
- **Категорія послуги** (вибір):
  - Чистка одягу та текстилю
  - Прання білизни
  - Прасування
  - Чистка та відновлення шкіряних виробів
  - Дублянки
  - Вироби із натурального хутра
  - Фарбування текстильних виробів

- **Найменування виробу** (динамічний список на основі вибраної категорії)
  
- **Одиниця виміру і кількість**:
  - Штуки (для більшості виробів)
  - Кілограми (для білизни та певних текстильних виробів)
  - Поле для введення числового значення

#### Підетап 2.2: Характеристики предмета
- **Матеріал** (вибір залежить від категорії):
  - Бавовна
  - Шерсть
  - Шовк
  - Синтетика
  - Гладка шкіра
  - Нубук
  - Спілок
  - Замша
  
- **Колір**:
  - Список базових кольорів для швидкого вибору
  - Поле для введення власного кольору
  
- **Наповнювач** (для відповідних категорій):
  - Пух
  - Синтепон
  - Інше (вручну)
  - Чекбокс "Збитий наповнювач"
  
- **Ступінь зносу** (вибір):
  - 10%
  - 30%
  - 50%
  - 75%

#### Підетап 2.3: Забруднення, дефекти та ризики
- **Плями** (мультивибір чекбоксів):
  - Жир
  - Кров
  - Білок
  - Вино
  - Кава
  - Трава
  - Чорнило
  - Косметика
  - Інше (з полем для уточнення)
  
- **Дефекти та ризики** (мультивибір чекбоксів):
  - Потертості
  - Порване
  - Відсутність фурнітури
  - Пошкодження фурнітури
  - Ризики зміни кольору
  - Ризики деформації
  - Без гарантій (з обов'язковим поясненням причин)
  
- **Примітки щодо дефектів** (текстове поле)

#### Підетап 2.4: Знижки та надбавки (калькулятор ціни)
- **Базова ціна** (автоматично з прайсу на основі вибраної категорії та найменування)

- **Коефіцієнти і модифікатори** (динамічно відображаються відповідно до категорії):

  - **Загальні коефіцієнти** (доступні для всіх категорій):
    - Дитячі речі (до 30 розміру) - 30% від вартості
    - Ручна чистка +20% до вартості
    - Дуже забруднені речі +від 20 до 100% до вартості
    - Термінова чистка +від 50 до 100% до вартості

  - **Модифікатори для текстильних виробів** (тільки для відповідних категорій):
    - Чистка виробів з хутряними комірами та манжетами +30% до вартості чистки
    - Нанесення водовідштовхуючого покриття +30% до вартості
    - Чистка виробів із натурального шовку, атласу, шифону +50% до вартості
    - Чистка комбінованих виробів (шкіра+текстиль) +100% до вартості чистки текстилю
    - Ручна чистка великих м'яких іграшок +100% до вартості чистки
    - Пришивання гудзиків (фіксована вартість за одиницю)
    - Чистка виробів чорного та світлих тонів +20% до вартості
    - Чистка весільної сукні зі шлейфом +30%

  - **Модифікатори для шкіряних виробів** (тільки для шкіряних категорій):
    - Прасування шкіряних виробів 70% від вартості чистки
    - Нанесення водовідштовхуючого покриття +30% до вартості послуги
    - Фарбування (після нашої чистки) +50% до вартості послуги
    - Фарбування (після чистки деінде) 100% вартість чистки
    - Чистка шкіряних виробів із вставками (шкіра іншого кольору, текстиль, хутро) +30% до вартості
    - Нанесення перламутрового покриття +30% до вартості послуги
    - Чистка натуральних дублянок на штучному хутрі -20% від вартості
    - Пришивання гудзиків (фіксована вартість за одиницю)
    - Ручна чистка виробів зі шкіри +30% до вартості чистки

- **Інтерактивний розрахунок ціни з деталізацією**:
  - Відображення базової ціни
  - Покрокова деталізація впливу кожного модифікатора на ціну
  - Відображення проміжних розрахунків
  - Підсумкова ціна за предмет

#### Підетап 2.5: Фотодокументація
- **Завантаження фото**:
  - Кнопка для зйомки з камери планшета
  - Кнопка для завантаження з галереї
  - Попередній перегляд завантажених фото
  
- **Анотування фото**:
  - Можливість позначити на фото проблемні місця
  - Додавання текстових приміток до кожного фото
  
- **Галерея фото предмета** з попереднім переглядом

#### Завершення додавання предмета
- **Підсумок інформації про предмет**
- **Кнопка "Додати до замовлення"**
- **Після додавання**: повернення до головного екрана менеджера предметів (2.0)
- **Можливість**: додати ще один предмет або перейти до наступного етапу

### Етап 3: Загальні параметри замовлення

#### 3.1. Параметри виконання
- **Дата виконання**:
  - Календар з вибором дати
  - Автоматичний розрахунок на основі категорій доданих предметів
  - Інформація про стандартні терміни (48 годин для звичайних/14 днів для шкіри)

- **Термінове виконання** (мультивибір):
  - Звичайне (без націнки)
  - +50% за 48 год
  - +100% за 24 год
  - Автоматичний перерахунок дати виконання при зміні

#### 3.2. Знижки (глобальні для замовлення)
- **Тип знижки** (вибір один):
  - Без знижки
  - Еверкард (10%)
  - Соцмережі (5%)
  - ЗСУ (10%)
  - Інше (з полем для вводу відсотка)
  
- **Важливе обмеження** (система повинна перевіряти автоматично):
  - Знижки не діють на прасування, прання і фарбування текстилю
  - Відображення попередження якщо вибрана знижка не може бути застосована
  - Автоматичне виключення неприйнятних категорій зі знижки

#### 3.3. Оплата
- **Спосіб оплати** (вибір один):
  - Термінал
  - Готівка
  - На рахунок
  
- **Фінансові деталі**:
  - Загальна вартість (сума всіх предметів з урахуванням знижок/надбавок)
  - Сплачено (поле для введення суми передоплати)
  - Борг (розраховується автоматично як різниця)

#### 3.4. Додаткова інформація
- **Примітки до замовлення** (загальні)
- **Додаткові вимоги клієнта**

### Етап 4: Підтвердження та завершення з формуванням квитанції

#### 4.1. Перегляд замовлення з детальним розрахунком
- **Повний підсумок замовлення**:
  - Інформація про клієнта
  - Список предметів з детальною інформацією
  - Повний розрахунок вартості з деталізацією для кожного предмета:
    - Базова ціна
    - Застосовані модифікатори з відсотками та сумами
    - Фінальна ціна за кожен предмет
  - Загальний розрахунок з урахуванням глобальних знижок та терміновості
  - Дата виконання

#### 4.2. Юридичні аспекти
- **Чекбокс** "Я погоджуюсь з умовами надання послуг" (обов'язковий)
- **Посилання на державні документи** для ознайомлення
- **Цифровий підпис клієнта**:
  - Вікно для підпису на сенсорному екрані
  - Кнопка "Очистити" для повторного підпису
  - Кнопка "Зберегти підпис"

#### 4.3. Формування та друк квитанції

- **Автоматичне генерування квитанції** на основі всієї введеної інформації
- **Структура квитанції**:
  - **Шапка**:
    - Логотип хімчистки
    - Назва та юридична інформація компанії
    - Адреса та контактні дані
    - Пункт прийому (філія)
    - Прізвище та ініціали оператора
  - **Інформація про замовлення**:
    - Номер квитанції
    - Номер унікальної мітки
    - Дата створення замовлення
    - Орієнтовна дата видачі (чітко вказати "після 14:00")
  - **Інформація про клієнта**:
    - ПІБ
    - Контактний телефон
    - Обраний спосіб зв'язку
    - Адреса (якщо вказана)
  - **Таблиця предметів з деталізацією розрахунку**:
    - Порядковий номер
    - Найменування предмета
    - Категорія послуги
    - Кількість/вага
    - Матеріал
    - Колір
    - Наповнювач (якщо є)
    - Базова вартість
    - Детальний розрахунок із модифікаторами (розгорнута секція):
      - Базова ціна
      - Кожен застосований модифікатор з його впливом на ціну
      - Фінальна ціна за предмет
  - **Розділ забруднень і дефектів**:
    - Перелік виявлених плям (за типом)
    - Перелік дефектів та ризиків
    - Примітка "Без гарантій" (якщо застосовується)
  - **Фінансова інформація**:
    - Вартість послуг до знижок
    - Знижка (якщо застосовується, з вказаним типом)
    - Надбавка за терміновість (якщо застосовується)
    - Загальна вартість
    - Сплачено (передоплата)
    - Залишок до сплати при отриманні
    - Спосіб оплати
  - **Юридична інформація**:
    - Стандартні умови надання послуг
    - Обмеження відповідальності
    - Інформація про можливі ризики
    - Посилання на повні умови договору
  - **Підписи**:
    - Місце для цифрового підпису клієнта (при здачі)
    - Місце для підпису клієнта при отриманні
    - Підпис оператора
    - Печатка компанії (якщо застосовується)
  - **Нижній колонтитул**:
    - Контактна інформація для зв'язку
    - Графік роботи
    - QR-код для відстеження статусу замовлення (якщо реалізовано)

- **Опції видачі квитанції**:
  - Автоматичний друк після завершення оформлення
  - Друк у двох примірниках (для клієнта та для хімчистки)
  - Можливість повторного друку
  - Відправлення PDF-копії на email клієнта (за бажанням)

#### 4.4. Завершення процесу
- **Підтвердження успішного завершення**:
  - Повідомлення про успішне створення замовлення
  - Інформація про надіслані копії
  - Нагадування про дату готовності
- **Додаткові дії**:
  - Перехід до створення нового замовлення
  - Повернення до списку замовлень

## Логіка розрахунку вартості

### 1. Правила застосування знижок і надбавок
- Знижки на все замовлення не поширюються на послуги прання, прасування та фарбування текстилю
- Спочатку розраховуються надбавки за додаткові послуги, потім застосовуються знижки
- При накладанні кількох надбавок, вони додаються до базової ціни послідовно (не перемножуються)

### 2. Процес розрахунку вартості для кожного предмета
1. **Базова ціна** (з прайсу на основі категорії та найменування)
2. **Перевірка кольорових виробів** - для кольорових виробів може бути різна ціна для чорного та інших кольорів
3. **Застосування особливих модифікаторів** - наприклад "Фарбування після чистки деінде" може замінювати базову ціну
4. **Застосування множників** - коефіцієнти для матеріалу, стану, додаткових послуг
5. **Додавання фіксованих послуг** - наприклад, пришивання гудзиків за фіксованою ціною
6. **Терміновість** (якщо вибрана): +50% або +100% до проміжної суми
7. **Знижки** (якщо застосовуються і дозволені для цієї категорії)
8. **Округлення** до копійок (2 знаки після коми)

### 3. Інтелектуальні залежності
- При виборі категорії автоматично оновлюється:
  - Список доступних найменувань
  - Список можливих матеріалів
  - Набір доступних додаткових послуг
  - Одиниця виміру (шт/кг)
  - Очікуваний термін виконання

- При виборі терміновості:
  - Перераховується вартість усіх предметів
  - Оновлюється дата виконання

- При виборі певних типів забруднень:
  - Система автоматично пропонує відповідні додаткові послуги
  - Може з'явитися попередження про ризики

## Прозорість розрахунків

### 1. Інтерактивна прозорість у процесі оформлення
- Під час вибору послуг і модифікаторів відображається:
  - Базова ціна
  - Вплив кожного модифікатора (у відсотках та грошах)
  - Проміжні суми на кожному етапі розрахунку
  - Фінальна ціна за предмет

### 2. Детальний підсумок на етапі підтвердження
- Для кожного предмета відображається:
  - Базова інформація (назва, кількість)
  - Розгорнутий розрахунок ціни (модифікатори, знижки)
  - Фінальна ціна
- Для всього замовлення відображається:
  - Сума по всіх предметах
  - Загальні знижки та надбавки
  - Сума до сплати

### 3. Структурована квитанція з деталізацією
- Квитанція містить:
  - Повний перелік предметів
  - Розгорнуту деталізацію розрахунку для кожного предмета
  - Чітке відображення всіх застосованих модифікаторів
  - Прозорий розрахунок фінальної суми

## Інтеграція з базою даних

### 1. Структура прайс-листа
- **Категорії послуг** (ServiceCategory):
  - ID, код, назва, опис
- **Прайс-лист** (PriceListItem):
  - ID, категорія, номер, назва, одиниця виміру, базова ціна
  - Додаткові поля для особливих випадків (чорний/інші кольори)

### 2. Зберігання коефіцієнтів
- Коефіцієнти зберігаються в коді Order Wizard (не в базі даних)
- Це дозволяє гнучко налаштовувати логіку розрахунку без зміни структури бази

### 3. Зберігання замовлень
- Замовлення зберігаються з повною деталізацією розрахунків
- Це дозволяє відтворити розрахунок у будь-який момент

## Рекомендації щодо реалізації

### 1. Адаптивний інтерфейс
- **Використання динамічних макетів**: Один або два стовпці залежно від розміру екрану
- **Оптимізація для тач-інтерфейсу**: Збільшені елементи керування
- **Спеціальні компоненти для планшетів**: Адаптовані форми вводу

### 2. Оптимізація продуктивності
- **Кешування прайс-листа**: Для швидкого доступу до цін
- **Поступове завантаження**: Завантаження тільки потрібних даних
- **Оптимізація розрахунків**: Ефективні алгоритми для складних формул

### 3. Безпека та збереження даних
- **Автозбереження**: Збереження чернетки замовлення
- **Валідація даних**: Перевірка введених даних
- **Резервне копіювання**: Захист від втрати даних

## Висновок

Запропонована структура Order Wizard забезпечує повний цикл оформлення замовлень у хімчистці:
- Зручний вибір клієнта та предметів
- Гнучка система розрахунку вартості з прозорою деталізацією
- Детальна документація зі специфічними деталями для кожного предмета
- Формування професійної квитанції з усією необхідною інформацією

