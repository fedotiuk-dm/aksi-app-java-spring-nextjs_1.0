# План впровадження стандартів коду

Цей документ описує поетапний план впровадження стандартів коду в проекті "Хімчистка AKSI".

## Загальні етапи

Впровадження стандартів коду відбуватиметься поступово, щоб не порушити поточну роботу та розробку проекту:

### Фаза 1: Підготовка та налаштування інструментів

**Термін виконання**: 1-2 тижні

1. **Налаштування Checkstyle**:
   - Оновлення конфігурації Checkstyle у `checkstyle.xml`
   - Додавання suppressions для поточних проблем
   - Налаштування Maven-плагіна

2. **Підготовка автоматизованих скриптів**:
   - Доопрацювання існуючих скриптів виправлення
   - Створення нових скриптів для автоматизації рефакторингу
   - Тестування скриптів на невеликій частині кодової бази

3. **Документування стандартів**:
   - Поширення документації серед команди розробників
   - Проведення обговорення та внесення уточнень
   - Затвердження фінальної версії стандартів

### Фаза 2: Базові покращення стилю коду

**Термін виконання**: 2-4 тижні

1. **Виправлення базових помилок форматування**:
   - Запуск `fix_trailing_spaces.py` для видалення пробілів та додавання рядків у кінці файлів
   - Запуск `fix_imports.py` для упорядкування імпортів
   - Коміт змін з описовим повідомленням

2. **Додавання модифікаторів `final`**:
   - Запуск `fix_final_modifiers.py` для додавання модифікаторів `final` до параметрів методів
   - Запуск `fix_final_modifiers.py` для додавання модифікаторів `final` до локальних змінних
   - Коміт змін з описовим повідомленням

3. **Виправлення документації**:
   - Запуск `fix_javadoc_periods.py` для додавання крапок у кінці перших речень Javadoc
   - Додавання відсутньої документації до публічних класів та методів
   - Коміт змін з описовим повідомленням

### Фаза 3: Видалення "магічних чисел" та хардкоду

**Термін виконання**: 2-3 тижні

1. **Виявлення та аналіз "магічних чисел"**:
   - Запуск `fix_magic_numbers.py` для виявлення всіх "магічних чисел"
   - Аналіз контексту використання та групування за призначенням
   - Створення плану заміни на константи

2. **Введення констант**:
   - Створення класів констант для різних категорій значень
   - Поетапна заміна "магічних чисел" на константи
   - Регулярні коміти змін для спрощення code review

3. **Видалення хардкодованих URL та конфігурації**:
   - Перенесення URL-адрес до конфігураційних файлів
   - Перенесення таймаутів та інших параметрів до конфігурації
   - Перевірка функціональності після змін

### Фаза 4: Відповідність DDD

**Термін виконання**: 4-6 тижнів

1. **Аналіз поточної архітектури**:
   - Порівняння з принципами DDD
   - Виявлення невідповідностей та проблемних місць
   - Створення плану рефакторингу

2. **Рефакторинг сутностей**:
   - Перейменування класів згідно зі стандартами (додавання суфікса "Entity")
   - Додавання бізнес-методів до сутностей
   - Реорганізація зв'язків між сутностями

3. **Рефакторинг сервісів**:
   - Розділення на інтерфейси та реалізації
   - Перевірка дотримання принципу Single Responsibility
   - Оптимізація транзакційної логіки

4. **Рефакторинг репозиторіїв**:
   - Перегляд та оптимізація запитів
   - Додавання спеціалізованих методів пошуку
   - Перевірка відповідності репозиторіїв агрегатам

### Фаза 5: Стандартизація API

**Термін виконання**: 2-3 тижні

1. **Узгодження URL-шляхів**:
   - Запуск `standardize_api_paths.py` для виявлення невідповідностей
   - Перевірка на дублювання `/api` префікса
   - Перевірка на відповідність kebab-case

2. **Стандартизація запитів та відповідей**:
   - Перевірка форматів DTO
   - Узгодження іменування полів
   - Уніфікація повідомлень валідації

3. **Покращення документації API**:
   - Додавання анотацій OpenAPI до всіх ендпоінтів
   - Опис параметрів та кодів відповіді
   - Перевірка коректності згенерованої документації

### Фаза 6: Обробка винятків

**Термін виконання**: 2 тижні

1. **Аналіз поточної обробки винятків**:
   - Виявлення місць з ігноруванням винятків
   - Аналіз непокритих типів помилок
   - Створення списку необхідних вдосконалень

2. **Створення ієрархії винятків**:
   - Розробка базових класів винятків
   - Створення спеціалізованих винятків для різних доменів
   - Документування кодів помилок

3. **Оновлення GlobalExceptionHandler**:
   - Додавання обробників для нових типів винятків
   - Стандартизація формату відповідей про помилки
   - Покращення логування помилок

### Фаза 7: Впровадження шаблонів

**Термін виконання**: 1-2 тижні

1. **Створення шаблонів для IDE**:
   - Налаштування Live Templates в IntelliJ IDEA
   - Створення сніпетів для VS Code
   - Розповсюдження шаблонів серед команди розробників

2. **Тренінг команди**:
   - Проведення семінару з використання нових стандартів
   - Демонстрація використання шаблонів
   - Відповіді на питання та обговорення

3. **Налаштування CI/CD**:
   - Інтеграція перевірки стилю коду в пайплайн CI
   - Налаштування автоматизованих звітів про проблеми
   - Блокування PR, які не відповідають стандартам

## Реалізація для конкретних модулів

### Модуль "Клієнти"

1. **Фаза 2 (Базові покращення)**:
   - `ClientsController.java`
   - `ClientServiceImpl.java`
   - `ClientRepository.java`

2. **Фаза 4 (Відповідність DDD)**:
   - Перейменування `Client.java` на `ClientEntity.java`
   - Додавання бізнес-методів до `ClientEntity`
   - Перегляд зв'язків з іншими сутностями

### Модуль "Замовлення" (OrderWizard)

1. **Фаза 3 (Видалення "магічних чисел")**:
   - `OrderServiceImpl.java`
   - `OrderPaymentController.java`

2. **Фаза 4 (Відповідність DDD)**:
   - Реорганізація агрегату замовлення
   - Перенесення бізнес-логіки до сутностей
   - Ізоляція логіки ціноутворення

3. **Фаза 5 (Стандартизація API)**:
   - Уніфікація ендпоінтів OrderWizard
   - Стандартизація форматів запитів та відповідей

## Критерії успіху

1. **Зменшення попереджень Checkstyle** до менш ніж 100 на весь проект
2. **Відсутність "магічних чисел"** у коді
3. **Уніфіковані імена класів** з відповідними суфіксами
4. **Стандартизовані REST API** ендпоінти
5. **Документовані всі публічні API** за допомогою OpenAPI
6. **Повна ієрархія винятків** з відповідною обробкою
7. **Впроваджені шаблони** для нових компонентів

## Моніторинг прогресу

1. **Щотижневі звіти** про прогрес впровадження
2. **Автоматизована метрика якості коду** через інтеграцію з SonarQube
3. **Відстеження успішності збірок** у CI-пайплайн
4. **Періодичний аналіз нового коду** на відповідність стандартам

## Ризики та їх пом'якшення

1. **Ризик**: Порушення працездатності під час рефакторингу
   **Пом'якшення**: Поступове впровадження змін з повним покриттям тестами

2. **Ризик**: Спротив команди до нових стандартів
   **Пом'якшення**: Детальне пояснення переваг, тренінг та підтримка

3. **Ризик**: Затримки в розробці нового функціоналу
   **Пом'якшення**: Розподіл впровадження на маленькі, керовані задачі
