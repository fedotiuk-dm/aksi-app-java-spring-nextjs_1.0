#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫—É Aksi-app —É —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏

echo "üöÄ –ó–∞–ø—É—Å–∫ Aksi-app —É —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏"

# –ó—É–ø–∏–Ω—è—î–º–æ –≤—Å—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, —è–∫—â–æ –≤–æ–Ω–∏ –∑–∞–ø—É—â–µ–Ω—ñ
echo "üîÑ –ó—É–ø–∏–Ω—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏..."
docker-compose -f docker-compose.dev.yml down

# –í–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ —ñ—Å–Ω—É—é—á—ñ –æ–±—Ä–∞–∑–∏ –¥–ª—è dev-—Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
echo "üßπ –í–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä—ñ –æ–±—Ä–∞–∑–∏..."
docker rmi -f $(docker images | grep '*-dev' | awk '{print $3}') 2>/dev/null || true

# –ü–µ—Ä–µ–±—É–¥–æ–≤—É—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –±–µ–∑ –∫–µ—à—É
echo "üèóÔ∏è –ü–µ—Ä–µ–±—É–¥–æ–≤—É—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –±–µ–∑ –∫–µ—à—É..."
docker-compose -f docker-compose.dev.yml build --no-cache

# –ó–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
echo "‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏..."
docker-compose -f docker-compose.dev.yml up -d

# –ü–æ–∫–∞–∑—É—î–º–æ –ª–æ–≥–∏
echo "üìã –ü–æ–∫–∞–∑—É—î–º–æ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤..."
echo "–î–ª—è –≤–∏—Ö–æ–¥—É –∑ –ª–æ–≥—ñ–≤ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Ctrl+C"
echo "–¶–µ –ù–ï –∑—É–ø–∏–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏!"
docker-compose -f docker-compose.dev.yml logs -f

# –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –ø—ñ—Å–ª—è –≤–∏—Ö–æ–¥—É –∑ –ª–æ–≥—ñ–≤
echo "‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∑–∞–ø—É—â–µ–Ω–æ!"
echo "üåê –î–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤—ñ—Å—ñ–≤:"
echo "   Frontend: http://localhost:3000"
echo "   Backend: http://localhost:8080/api"
echo "   PgAdmin: http://localhost:5050"
echo ""
echo "‚ùì –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–º–∞–Ω–¥–∏:"
echo "   –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤: docker-compose -f docker-compose.dev.yml logs -f"
echo "   –ó—É–ø–∏–Ω–∫–∞: docker-compose -f docker-compose.dev.yml down"
