# Wizard Domain Hooks - –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ "DDD inside, FSD outside"

## –ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥

–•—É–∫–∏ wizard –¥–æ–º–µ–Ω—É –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω—ñ –∑–∞ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º **"–æ–¥–∏–Ω —Ö—É–∫ - –æ–¥–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å"** —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –µ—Ç–∞–ø—ñ–≤ Order Wizard. –ö–æ–∂–µ–Ω —Ö—É–∫ —î "—Ç–æ–Ω–∫–∏–º" —Ç–∞ –¥–µ–ª–µ–≥—É—î –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º –¥–æ–º–µ–Ω–Ω–∏–º —Å–µ—Ä–≤—ñ—Å–∞–º.

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

### 1. –†–æ–∑–ø–æ–¥—ñ–ª –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ

```
React Hook ‚Üî Domain Service ‚Üî Adapter ‚Üî API Service ‚Üî Backend
```

- **React Hook** - —Ç—ñ–ª—å–∫–∏ React —Å—Ç–∞–Ω —Ç–∞ UI –ª–æ–≥—ñ–∫–∞
- **Domain Service** - –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è
- **Adapter** - –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤, API —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- **Zod Schemas** - –≤—Å—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ–æ—Ä–º —Ç–∞ –¥–∞–Ω–∏—Ö
- **API Service** - –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ OpenAPI –∫–ª—ñ—î–Ω—Ç–∏

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞ –µ—Ç–∞–ø–∞–º–∏

–•—É–∫–∏ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ 5 –µ—Ç–∞–ø—ñ–≤ Order Wizard:

```
hooks/
‚îú‚îÄ‚îÄ shared/                    # –°–ø—ñ–ª—å–Ω—ñ —Ö—É–∫–∏ (–Ω–∞–≤—ñ–≥–∞—Ü—ñ—è, —Å—Ç–∞–Ω, —Ñ–æ—Ä–º–∏)
‚îú‚îÄ‚îÄ steps/
‚îÇ   ‚îú‚îÄ‚îÄ client-selection/      # –ï—Ç–∞–ø 1: –ö–ª—ñ—î–Ω—Ç —Ç–∞ –±–∞–∑–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ branch-selection/      # –ï—Ç–∞–ø 2: –í–∏–±—ñ—Ä —Ñ—ñ–ª—ñ—ó —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ item-management/       # –ï—Ç–∞–ø 3: –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ (—Ü–∏–∫–ª—ñ—á–Ω–∏–π)
‚îÇ   ‚îú‚îÄ‚îÄ order-parameters/      # –ï—Ç–∞–ø 4: –ó–∞–≥–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
‚îÇ   ‚îî‚îÄ‚îÄ order-completion/      # –ï—Ç–∞–ø 5: –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
‚îî‚îÄ‚îÄ index.ts                   # –ü—É–±–ª—ñ—á–Ω–µ API
```

### 3. –¢–∏–ø–∏ —Ö—É–∫—ñ–≤

#### –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ —Ö—É–∫–∏

–í—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:

- `useClientSearch` - –ø–æ—à—É–∫ –∫–ª—ñ—î–Ω—Ç—ñ–≤
- `useItemPricingCalculator` - —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ü—ñ–Ω
- `useReceiptGeneration` - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–≤–∏—Ç–∞–Ω—Ü—ñ–π

#### –ö–æ–º–ø–æ–∑–∏—Ü—ñ–π–Ω—ñ —Ö—É–∫–∏

–û–±'—î–¥–Ω—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –µ—Ç–∞–ø—É:

- `useClientSelectionStep` - –≤–µ—Å—å –µ—Ç–∞–ø –≤–∏–±–æ—Ä—É –∫–ª—ñ—î–Ω—Ç–∞
- `useItemManagementStep` - –≤–µ—Å—å –µ—Ç–∞–ø —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏

## –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

- **–ï—Ç–∞–ø 1**: –ö–ª—ñ—î–Ω—Ç —Ç–∞ –±–∞–∑–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
  - `useClientSearch` - –ø–æ—à—É–∫ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é
  - `useClientForm` - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞
  - `useClientSelection` - –≤–∏–±—ñ—Ä –∫–ª—ñ—î–Ω—Ç–∞ –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

### üîÑ –í —Ä–æ–∑—Ä–æ–±—Ü—ñ

- **–°–ø—ñ–ª—å–Ω—ñ —Ö—É–∫–∏**: –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è, —Å—Ç–∞–Ω, —Ñ–æ—Ä–º–∏

### üìã –ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–æ

- **–ï—Ç–∞–ø 2**: –í–∏–±—ñ—Ä —Ñ—ñ–ª—ñ—ó —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞—Ü—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **–ï—Ç–∞–ø 3**: –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ (–Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–∏–π)
- **–ï—Ç–∞–ø 4**: –ó–∞–≥–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **–ï—Ç–∞–ø 5**: –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è

## –ü—Ä–∞–≤–∏–ª–∞ —Ä–æ–∑—Ä–æ–±–∫–∏ —Ö—É–∫—ñ–≤

### 1. –ù–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

```
use-[function-name].hook.ts
```

–ü—Ä–∏–∫–ª–∞–¥–∏:

- `use-client-search.hook.ts`
- `use-item-pricing-calculator.hook.ts`
- `use-order-completion-step.hook.ts`

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—É–∫–∞

```typescript
export const useFeatureName = () => {
  // 1. React —Å—Ç–∞–Ω (—Ç—ñ–ª—å–∫–∏ UI —Å—Ç–∞–Ω)
  const [isLoading, setIsLoading] = useState(false);

  // 2. Zustand —Å—Ç–∞–Ω (—á–µ—Ä–µ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏)
  const { data, actions } = useWizardStore(selector);

  // 3. –î–æ–º–µ–Ω–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ (—ñ–Ω'—î–∫—Ü—ñ—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π)
  const service = useMemo(() => new FeatureService(), []);

  // 4. –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π (–¥–µ–ª–µ–≥—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å–∞–º)
  const handleAction = useCallback(
    async (params) => {
      setIsLoading(true);
      try {
        const result = await service.performAction(params);
        actions.updateState(result);
      } catch (error) {
        // –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
      } finally {
        setIsLoading(false);
      }
    },
    [service, actions]
  );

  // 5. –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è API —Ö—É–∫–∞
  return {
    // –°—Ç–∞–Ω
    isLoading,
    data,

    // –î—ñ—ó
    handleAction,

    // –£—Ç–∏–ª—ñ—Ç–∏
    canPerformAction: service.canPerformAction(data),
  };
};
```

### 3. –í–∞–ª—ñ–¥–∞—Ü—ñ—è

- **–ù–ï** —Ä–æ–±–∏—Ç–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –≤ —Ö—É–∫–∞—Ö
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Zod —Å—Ö–µ–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ö
- –î–µ–ª–µ–≥—É–≤–∞—Ç–∏ –±—ñ–∑–Ω–µ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—é —Å–µ—Ä–≤—ñ—Å–∞–º

### 4. API –≤–∏–∫–ª–∏–∫–∏

- **–ù–ï** —Ä–æ–±–∏—Ç–∏ –ø—Ä—è–º—ñ API –≤–∏–∫–ª–∏–∫–∏ –≤ —Ö—É–∫–∞—Ö
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–æ–º–µ–Ω–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏
- –°–µ—Ä–≤—ñ—Å–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∞–¥–∞–ø—Ç–µ—Ä–∏ –¥–ª—è API

## –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –¥–æ–º–µ–Ω–æ–º

### Zustand Store

–ö–æ–∂–µ–Ω —Ö—É–∫ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É —á–µ—Ä–µ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏:

```typescript
const { selectedClient, setSelectedClient } = useWizardStore((state) => ({
  selectedClient: state.selectedClient,
  setSelectedClient: state.setSelectedClient,
}));
```

### –ù–∞–≤—ñ–≥–∞—Ü—ñ—è

–í—Å—ñ —Ö—É–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å `useWizardNavigation` –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤ –º—ñ–∂ –µ—Ç–∞–ø–∞–º–∏:

```typescript
const { goToNextStep, goToPreviousStep, canProceed } = useWizardNavigation();
```

### –í–∞–ª—ñ–¥–∞—Ü—ñ—è

–•—É–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≥–æ—Ç–æ–≤—ñ Zod —Å—Ö–µ–º–∏:

```typescript
const { register, handleSubmit, formState } = useWizardForm({
  schema: clientSchema,
  defaultValues: initialData,
});
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Unit —Ç–µ—Å—Ç–∏

–ö–æ–∂–µ–Ω —Ö—É–∫ –º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —Ç–µ—Å—Ç–∏:

```
__tests__/
‚îú‚îÄ‚îÄ use-client-search.test.ts
‚îú‚îÄ‚îÄ use-client-form.test.ts
‚îî‚îÄ‚îÄ use-client-selection.test.ts
```

### –ú–æ–∫–∏

- –î–æ–º–µ–Ω–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ –º–æ–∫–∞—é—Ç—å—Å—è
- API –∞–¥–∞–ø—Ç–µ—Ä–∏ –º–æ–∫–∞—é—Ç—å—Å—è
- Zustand —Å—Ç–æ—Ä –º–æ–∫–∞—î—Ç—å—Å—è

## –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –í UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```typescript
// features/order-wizard/client-selection/ui/ClientSelectionStep.tsx
export const ClientSelectionStep = () => {
  const {
    searchTerm,
    results,
    isSearching,
    handleSearch
  } = useClientSearch();

  const {
    selectedClient,
    handleSelectClient
  } = useClientSelection();

  return (
    <div>
      {/* UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ç—ñ–ª—å–∫–∏ –¥–∞–Ω—ñ —Ç–∞ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –∑ —Ö—É–∫—ñ–≤ */}
    </div>
  );
};
```

### –ö–æ–º–ø–æ–∑–∏—Ü—ñ—è —Ö—É–∫—ñ–≤

```typescript
// –ö–æ–º–ø–æ–∑–∏—Ü—ñ–π–Ω–∏–π —Ö—É–∫ –¥–ª—è –≤—Å—å–æ–≥–æ –µ—Ç–∞–ø—É
export const useClientSelectionStep = () => {
  const search = useClientSearch();
  const form = useClientForm();
  const selection = useClientSelection();

  return {
    search,
    form,
    selection,

    // –î–æ–¥–∞—Ç–∫–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó
    canProceedToNextStep: selection.selectedClient !== null,
  };
};
```

## –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–µ—Å—Ç—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–∏–ø—ñ–≤
2. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó
3. **–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ** - –º–µ–º–æ—ñ–∑–∞—Ü—ñ—è —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ñ–≤
4. **–¢–∏–ø—ñ–∑–∞—Ü—ñ—è** - –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–∏–ø—ñ–∑–∞—Ü—ñ—ó –¥–ª—è –∫—Ä–∞—â–æ–≥–æ DX
