# Етап 4: Загальні параметри замовлення

## Опис етапу

Четвертий етап Order Wizard відповідає за:

- Встановлення параметрів виконання замовлення
- Застосування знижок на рівні замовлення
- Налаштування способу оплати
- Додавання загальних приміток

## Хуки етапу

### `useOrderExecution`

**Відповідальність:** Параметри виконання

- Встановлення дати виконання
- Вибір терміновості виконання (+50%, +100%)
- Автоматичний розрахунок дати на основі категорій предметів
- Перерахунок вартості при зміні терміновості

### `useOrderDiscounts`

**Відповідальність:** Управління знижками

- Вибір типу знижки (Еверкард, Соцмережі, ЗСУ, Інше)
- Валідація застосування знижок (не діють на прасування, прання, фарбування)
- Автоматичне виключення неприйнятних категорій
- Перерахунок вартості з урахуванням знижок

### `useOrderPayment`

**Відповідальність:** Налаштування оплати

- Вибір способу оплати (Термінал, Готівка, На рахунок)
- Розрахунок загальної вартості
- Введення суми передоплати
- Автоматичний розрахунок боргу

### `useOrderAdditionalInfo`

**Відповідальність:** Додаткова інформація

- Додавання приміток до замовлення
- Додаткові вимоги клієнта
- Спеціальні інструкції

### `useOrderParametersStep` (композиційний)

**Відповідальність:** Координація всього етапу

- Об'єднання всіх параметрів замовлення
- Валідація готовності до переходу
- Фінальний розрахунок вартості

## Бізнес-правила

### Знижки

- Знижки не діють на прасування, прання і фарбування текстилю
- Система автоматично перевіряє та попереджає про обмеження
- Неприйнятні категорії автоматично виключаються зі знижки

### Терміновість

- Звичайне виконання: без націнки
- +50% за 48 годин
- +100% за 24 години
- Автоматичний перерахунок дати виконання

### Розрахунок вартості

1. Сума всіх предметів з модифікаторами
2. Застосування терміновості (якщо вибрана)
3. Застосування знижок (з урахуванням обмежень)
4. Фінальна сума до сплати

## Інтеграція з доменом

- **Zustand Store:** `orderParameters`, `orderTotals`, `paymentInfo`
- **Навігація:** `useWizardNavigation` для переходів
- **Валідація:** Zod схеми для параметрів замовлення
- **Сервіси:** `OrderCalculationService`, `DiscountService`
