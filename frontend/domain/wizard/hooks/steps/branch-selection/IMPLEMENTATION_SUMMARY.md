# Stage 2: Branch Selection - –ó–≤—ñ—Ç –ø—Ä–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é

## –í–∏–∫–æ–Ω–∞–Ω—ñ —Ä–æ–±–æ—Ç–∏

### ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω—ñ —Ö—É–∫–∏

#### 1. `useBranchLoading` - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ—ñ–ª—ñ–π

- **–§–∞–π–ª**: `use-branch-loading.hook.ts`
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏ –º–æ–Ω—Ç—É–≤–∞–Ω–Ω—ñ
  - –ö–µ—à—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ BranchService
  - –ü—Ä–∏–º—É—Å–æ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑ –æ—á–∏—â–µ–Ω–Ω—è–º –∫–µ—à—É
  - –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

#### 2. `useBranchSearch` - –ü–æ—à—É–∫ —Ñ—ñ–ª—ñ–π

- **–§–∞–π–ª**: `use-branch-search.hook.ts`
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**:
  - –î–µ–±–∞—É–Ω—Å–∏–Ω–≥ (300ms –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
  - –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –Ω–∞–∑–≤–æ—é, –∞–¥—Ä–µ—Å–æ—é, –∫–æ–¥–æ–º, —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
  - –ü–æ—à—É–∫ —Ç—ñ–ª—å–∫–∏ –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ñ—ñ–ª—ñ–π
  - –û—á–∏—â–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø–æ—à—É–∫—É

#### 3. `useBranchSelection` - –í–∏–±—ñ—Ä —Ñ—ñ–ª—ñ—ó

- **–§–∞–π–ª**: `use-branch-selection.hook.ts`
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**:
  - –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ—ñ–ª—ñ—ó —á–µ—Ä–µ–∑ BranchService
  - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É Zustand store
  - –û—á–∏—â–µ–Ω–Ω—è –≤–∏–±–æ—Ä—É
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è

#### 4. `useBranchSelectionStage` - –ö–æ–º–ø–æ–∑–∏—Ü—ñ–π–Ω–∏–π —Ö—É–∫

- **–§–∞–π–ª**: `use-branch-selection-stage.hook.ts`
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**:
  - –û–±'—î–¥–Ω—É—î –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ —Ö—É–∫–∏
  - –£–ø—Ä–∞–≤–ª—è—î –Ω–∞–≤—ñ–≥–∞—Ü—ñ—î—é
  - –û–±—á–∏—Å–ª—é—î —Å—Ç–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–æ—Å—Ç—ñ –µ—Ç–∞–ø—É
  - –õ–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥–µ–±–∞–≥—É

### ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–∏–π Zustand Store

#### –î–æ–¥–∞–Ω—ñ –ø–æ–ª—è –¥–æ `WizardState`:

```typescript
// Branch selection state
selectedBranchId: string | null;
selectedBranch: Branch | null;
branchValidationError: string | null;
```

#### –î–æ–¥–∞–Ω—ñ –¥—ñ—ó –¥–æ `WizardActions`:

```typescript
// Branch selection actions
setSelectedBranch: (branch: Branch) => void;
clearSelectedBranch: () => void;
setBranchValidationError: (error: string | null) => void;
```

### ‚úÖ –û–Ω–æ–≤–ª–µ–Ω—ñ —ñ–Ω–¥–µ–∫—Å–Ω—ñ —Ñ–∞–π–ª–∏

#### `frontend/domain/wizard/hooks/steps/branch-selection/index.ts`

- –ï–∫—Å–ø–æ—Ä—Ç –≤—Å—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏—Ö —Ö—É–∫—ñ–≤
- –ï–∫—Å–ø–æ—Ä—Ç –∫–æ–º–ø–æ–∑–∏—Ü—ñ–π–Ω–æ–≥–æ —Ö—É–∫–∞

#### `frontend/domain/wizard/hooks/index.ts`

- –î–æ–¥–∞–Ω–æ –µ–∫—Å–ø–æ—Ä—Ç —Ö—É–∫—ñ–≤ Stage 2
- –û–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ

### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

#### `README.md`

- –ü–æ–≤–Ω–∏–π –æ–ø–∏—Å –≤—Å—ñ—Ö —Ö—É–∫—ñ–≤
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–æ—é

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

### DDD inside, FSD outside

- ‚úÖ –í—Å—è –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ –≤ –¥–æ–º–µ–Ω–Ω–æ–º—É —à–∞—Ä—ñ
- ‚úÖ –•—É–∫–∏ —ñ–Ω–∫–∞–ø—Å—É–ª—é—é—Ç—å —Ä–æ–±–æ—Ç—É –∑ —Å–µ—Ä–≤—ñ—Å–∞–º–∏
- ‚úÖ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –≥–æ—Ç–æ–≤—ñ –¥–∞–Ω—ñ

### SOLID –ø—Ä–∏–Ω—Ü–∏–ø–∏

- ‚úÖ **SRP**: –ö–æ–∂–µ–Ω —Ö—É–∫ –º–∞—î –æ–¥–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å
- ‚úÖ **OCP**: –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±–µ–∑ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ–¥—É
- ‚úÖ **DIP**: –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ–π (BranchService)

### –¢–∏–ø—ñ–∑–∞—Ü—ñ—è

- ‚úÖ –°—Ç—Ä–æ–≥–∞ —Ç–∏–ø—ñ–∑–∞—Ü—ñ—è –≤—Å—ñ—Ö —Ö—É–∫—ñ–≤
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∏–ø—ñ–≤ –∑ –¥–æ–º–µ–Ω–Ω–æ–≥–æ —à–∞—Ä—É
- ‚úÖ –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –¥–ª—è –≤—Å—ñ—Ö –ø–æ–≤–µ—Ä—Ç–∞—î–º–∏—Ö –∑–Ω–∞—á–µ–Ω—å

## –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —ñ—Å–Ω—É—é—á–æ—é –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–æ—é

### –°–µ—Ä–≤—ñ—Å–∏

- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `BranchService` –¥–ª—è –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏
- ‚úÖ –ö–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –≤ —Å–µ—Ä–≤—ñ—Å–Ω–æ–º—É —à–∞—Ä—ñ

### Store

- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ `useWizardStore`
- ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—É —Ñ—ñ–ª—ñ—ó —Ç–∞ –ø–æ–º–∏–ª–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó

### –ù–∞–≤—ñ–≥–∞—Ü—ñ—è

- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ `useWizardNavigation`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ø–µ—Ä–µ—Ö–æ–¥—É

## –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```typescript
// –í UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ
'use client';

import { useBranchSelectionStage } from '@/domain/wizard/hooks';

export const BranchSelectionStep = () => {
  const {
    branches,
    isLoadingBranches,
    searchTerm,
    setSearchTerm,
    searchResults,
    selectedBranch,
    selectBranch,
    canProceedToNext,
    proceedToNext,
  } = useBranchSelectionStage();

  return (
    <div>
      {/* UI –¥–ª—è –ø–æ—à—É–∫—É —Ç–∞ –≤–∏–±–æ—Ä—É —Ñ—ñ–ª—ñ—ó */}
    </div>
  );
};
```

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 1: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

- [ ] Unit —Ç–µ—Å—Ç–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ö—É–∫–∞
- [ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏ –∑ BranchService
- [ ] –¢–µ—Å—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑—ñ store

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 2: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ UI

- [ ] –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —ñ—Å–Ω—É—é—á–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É UI
- [ ] –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è UX

### –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç 3: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

- [ ] –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- [ ] –î–æ–¥–∞—Ç–∫–æ–≤–µ –∫–µ—à—É–≤–∞–Ω–Ω—è
- [ ] –û–±—Ä–æ–±–∫–∞ edge cases

## –°—Ç–∞—Ç—É—Å

üü¢ **–ó–ê–í–ï–†–®–ï–ù–û** - Stage 2 —Ö—É–∫–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ç–∞ –≥–æ—Ç–æ–≤—ñ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ì–æ—Ç–æ–≤–æ –¥–æ:

- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ production

### –¢–µ—Ö–Ω—ñ—á–Ω–∏–π –±–æ—Ä–≥:

- –í—ñ–¥—Å—É—Ç–Ω—ñ unit —Ç–µ—Å—Ç–∏
- –ü–æ—Ç—Ä–µ–±—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ UI
