# Development Dockerfile for Next.js
FROM node:22.14.0-alpine3.20

WORKDIR /app

# Додаємо базові інструменти для розробки
RUN apk add --no-cache bash curl wget shadow

# Set environment variables for development
ENV NODE_ENV=development
ENV NEXT_TELEMETRY_DISABLED=1
# Використовуємо backend як ім'я Docker-сервісу для комунікації між контейнерами
ENV NEXT_PUBLIC_API_URL=http://backend:8080/api

# Expose the development server port
EXPOSE 3000

# Ми не використовуємо користувача nextjs, щоб уникнути проблем з правами доступу
# Створюємо тільки /app/node_modules з правильними правами
RUN mkdir -p /app/node_modules && \
    chmod 777 /app/node_modules

# Виконаємо npm install після монтування файлів
# Використовуємо --turbo для активації turbopack
CMD ["sh", "-c", "npm install && npm run dev -- --turbo"]

