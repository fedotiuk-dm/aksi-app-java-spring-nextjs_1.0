databaseChangeLog:
  - changeSet:
      id: clients-1.0-006
      author: ai-assistant
      comment: Оновлення поля source в таблиці clients - додавання constraint та коментарів
      preConditions:
        - onFail: MARK_RAN
          and:
            - tableExists:
                tableName: clients
            - columnExists:
                tableName: clients
                columnName: source
      changes:
        - sql:
            sql: "ALTER TABLE clients ADD CONSTRAINT chk_clients_source CHECK (source IN ('INSTAGRAM', 'GOOGLE', 'RECOMMENDATION', 'OTHER'))"
            comment: "Додавання check constraint для валідації значень ClientSource enum"
        - sql:
            sql: "COMMENT ON COLUMN clients.source IS 'Джерело інформації про хімчистку. Можливі значення: INSTAGRAM, GOOGLE, RECOMMENDATION, OTHER'"
            comment: "Додавання коментаря до колонки source"

  - changeSet:
      id: clients-1.0-007
      author: ai-assistant
      comment: Додавання індексу для поля source
      preConditions:
        - onFail: MARK_RAN
          not:
            - indexExists:
                indexName: idx_clients_source
      changes:
        - createIndex:
            indexName: idx_clients_source
            tableName: clients
            columns:
              - column:
                  name: source
            clustered: false
