databaseChangeLog:
  - changeSet:
      id: 1-insert-category-material-mappings-data
      author: aksi-app
      comment: Додаємо матеріали для всіх категорій
      changes:
        - sql:
            comment: Додаємо деякі матеріали для категорії одягу по коду (APPAREL)
            sql: |
              INSERT INTO category_material_mappings (id, category_id, material, sort_order)
              SELECT 
                gen_random_uuid(),
                sc.id,
                m.material,
                m.sort_order
              FROM 
                service_categories sc,
                (VALUES
                  ('Бавовна', 1),
                  ('Шерсть', 2),
                  ('Шовк', 3),
                  ('Синтетика', 4)
                ) AS m(material, sort_order)
              WHERE sc.code = 'APPAREL' AND
                NOT EXISTS (
                  SELECT 1 FROM category_material_mappings 
                  WHERE category_id = sc.id AND material = m.material
                );
              
        - sql:
            comment: Додаємо деякі матеріали для категорії взуття по коду (SHOES)
            sql: |
              INSERT INTO category_material_mappings (id, category_id, material, sort_order)
              SELECT 
                gen_random_uuid(),
                sc.id,
                m.material,
                m.sort_order
              FROM 
                service_categories sc,
                (VALUES
                  ('Гладка шкіра', 1),
                  ('Нубук', 2),
                  ('Спілок', 3),
                  ('Замша', 4)
                ) AS m(material, sort_order)
              WHERE sc.code = 'SHOES' AND
                NOT EXISTS (
                  SELECT 1 FROM category_material_mappings 
                  WHERE category_id = sc.id AND material = m.material
                );
              
        - sql:
            comment: Додаємо деякі матеріали для категорії домашнього текстилю по коду (HOME_TEXTILE)
            sql: |
              INSERT INTO category_material_mappings (id, category_id, material, sort_order)
              SELECT 
                gen_random_uuid(),
                sc.id,
                m.material,
                m.sort_order
              FROM 
                service_categories sc,
                (VALUES
                  ('Бавовна', 1),
                  ('Синтетика', 2),
                  ('Шерсть', 3),
                  ('Шовк', 4)
                ) AS m(material, sort_order)
              WHERE sc.code = 'HOME_TEXTILE' AND
                NOT EXISTS (
                  SELECT 1 FROM category_material_mappings 
                  WHERE category_id = sc.id AND material = m.material
                );
        # Додаємо записи для всіх інших категорій
        - sql:
            comment: Додаємо стандартні матеріали для всіх категорій, які ще не мають матеріалів
            sql: |
              INSERT INTO category_material_mappings (id, category_id, material, sort_order)
              SELECT 
                gen_random_uuid(), 
                sc.id, 
                'Бавовна', 
                1
              FROM service_categories sc
              WHERE NOT EXISTS (
                SELECT 1 FROM category_material_mappings cm 
                WHERE cm.category_id = sc.id
              );
              
              INSERT INTO category_material_mappings (id, category_id, material, sort_order)
              SELECT 
                gen_random_uuid(), 
                sc.id, 
                'Синтетика', 
                2
              FROM service_categories sc
              WHERE NOT EXISTS (
                SELECT 1 FROM category_material_mappings cm 
                WHERE cm.category_id = sc.id AND cm.material = 'Синтетика'
              );
              
        # Додаємо наповнювачі в таблицю fillings якщо таких ще немає
        - sql:
            comment: Додаємо наповнювачі, якщо їх немає
            sql: |
              INSERT INTO fillings (id, name, sort_order, is_active)
              SELECT 
                gen_random_uuid(),
                'Пух',
                1,
                true
              WHERE NOT EXISTS (
                SELECT 1 FROM fillings WHERE name = 'Пух'
              );
              
              INSERT INTO fillings (id, name, sort_order, is_active)
              SELECT 
                gen_random_uuid(),
                'Синтепон',
                2,
                true
              WHERE NOT EXISTS (
                SELECT 1 FROM fillings WHERE name = 'Синтепон'
              );
              
              INSERT INTO fillings (id, name, sort_order, is_active)
              SELECT 
                gen_random_uuid(),
                'Інше',
                3,
                true
              WHERE NOT EXISTS (
                SELECT 1 FROM fillings WHERE name = 'Інше'
              );
