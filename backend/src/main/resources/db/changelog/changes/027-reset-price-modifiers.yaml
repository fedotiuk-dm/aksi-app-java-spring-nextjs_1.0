databaseChangeLog:
  - changeSet:
      id: 027-reset-price-modifiers
      author: system
      comment: Clear existing price_modifiers and add correct ones from documentation
      changes:
        # Clear existing data
        - delete:
            tableName: modifier_category_restrictions
        - delete:
            tableName: discount_excluded_categories
        - delete:
            tableName: price_modifiers
        - delete:
            tableName: discounts
        
        # Add general modifiers
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "CHILD_ITEMS"}
              - column: {name: name, value: "Дитячі речі (до 30 розміру)"}
              - column: {name: description, value: "30% від базової ціни"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "-3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "10"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "MANUAL_CLEANING"}
              - column: {name: name, value: "Ручна чистка"}
              - column: {name: description, value: "Додаткова вартість за ручну обробку"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "2000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "20"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "VERY_DIRTY"}
              - column: {name: name, value: "Дуже забруднені речі"}
              - column: {name: description, value: "Від 20% до 100% надбавки"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "5000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "30"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "URGENT_CLEANING"}
              - column: {name: name, value: "Термінова чистка"}
              - column: {name: description, value: "Від 50% до 100% надбавки"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "5000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "40"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        # Textile modifiers
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "FUR_COLLAR"}
              - column: {name: name, value: "Чистка виробів з хутряними комірами та манжетами"}
              - column: {name: description, value: "Додаткова обробка хутряних елементів"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "50"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "WATER_REPELLENT"}
              - column: {name: name, value: "Нанесення водовідштовхуючого покриття"}
              - column: {name: description, value: "Захисне покриття для текстилю"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "60"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "SILK_FABRIC"}
              - column: {name: name, value: "Чистка виробів із натурального шовку, атласу, шифону"}
              - column: {name: description, value: "Делікатна обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "5000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "70"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "COMBINED_LEATHER_TEXTILE"}
              - column: {name: name, value: "Чистка комбінованих виробів (шкіра+текстиль)"}
              - column: {name: description, value: "Складна обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "10000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "80"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "LARGE_TOYS"}
              - column: {name: name, value: "Ручна чистка великих м'яких іграшок"}
              - column: {name: description, value: "Спеціальна обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "10000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "90"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "SEW_BUTTONS"}
              - column: {name: name, value: "Пришивання гудзиків"}
              - column: {name: description, value: "Фіксована вартість за гудзик"}
              - column: {name: modifier_type, value: "FIXED"}
              - column: {name: modifier_value, value: "500"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "100"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "BLACK_WHITE_COLORS"}
              - column: {name: name, value: "Чистка виробів чорного та світлих тонів"}
              - column: {name: description, value: "Додаткова обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "2000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "110"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "WEDDING_DRESS_TRAIN"}
              - column: {name: name, value: "Чистка весільної сукні зі шлейфом"}
              - column: {name: description, value: "Спеціальна обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "120"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        # Leather modifiers
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "IRON_LEATHER"}
              - column: {name: name, value: "Прасування шкіряних виробів"}
              - column: {name: description, value: "70% від вартості чистки"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "7000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "130"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "LEATHER_WATER_REPELLENT"}
              - column: {name: name, value: "Нанесення водовідштовхуючого покриття на шкіру"}
              - column: {name: description, value: "Захисне покриття"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "140"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "DYE_AFTER_OUR_CLEAN"}
              - column: {name: name, value: "Фарбування (після нашої чистки)"}
              - column: {name: description, value: "Фарбування шкіри"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "5000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "150"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "DYE_AFTER_OTHER_CLEAN"}
              - column: {name: name, value: "Фарбування (після чистки деінде)"}
              - column: {name: description, value: "Фарбування шкіри"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "10000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "160"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "LEATHER_WITH_INSERTS"}
              - column: {name: name, value: "Чистка шкіряних виробів із вставками"}
              - column: {name: description, value: "Додаткова обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "170"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "PEARL_COATING"}
              - column: {name: name, value: "Нанесення перламутрового покриття"}
              - column: {name: description, value: "Декоративне покриття"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "180"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "SHEEPSKIN_SYNTHETIC_FUR"}
              - column: {name: name, value: "Чистка натуральних дублянок на штучному хутрі"}
              - column: {name: description, value: "Знижка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "-2000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "190"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}
        
        - insert:
            tableName: price_modifiers
            columns:
              - column: {name: id, valueComputed: "gen_random_uuid()"}
              - column: {name: code, value: "MANUAL_LEATHER"}
              - column: {name: name, value: "Ручна чистка виробів зі шкіри"}
              - column: {name: description, value: "Додаткова обробка"}
              - column: {name: modifier_type, value: "PERCENTAGE"}
              - column: {name: modifier_value, value: "3000"}
              - column: {name: active, valueBoolean: "true"}
              - column: {name: sort_order, valueNumeric: "200"}
              - column: {name: created_at, valueComputed: "NOW()"}
              - column: {name: updated_at, valueComputed: "NOW()"}

        # Add discounts
        - sql:
            sql: |
              INSERT INTO discounts (id, code, name, description, percentage, active, sort_order, created_at, updated_at) VALUES 
              (gen_random_uuid(), 'EVERCARD', 'Еверкард', 'Знижка для власників картки Еверкард', 10, TRUE, 10, NOW(), NOW()),
              (gen_random_uuid(), 'SOCIAL_MEDIA', 'Соцмережі', 'Знижка для підписників в соцмережах', 5, TRUE, 20, NOW(), NOW()),
              (gen_random_uuid(), 'MILITARY', 'ЗСУ', 'Знижка для військовослужбовців', 10, TRUE, 30, NOW(), NOW());

        # Add category restrictions and exclusions
        - sql:
            sql: |
              -- Add category restrictions for textile modifiers
              INSERT INTO modifier_category_restrictions (modifier_id, category_code)
              SELECT id, 'CLOTHING' FROM price_modifiers WHERE code IN ('FUR_COLLAR', 'WATER_REPELLENT', 'SILK_FABRIC', 'COMBINED_LEATHER_TEXTILE', 'BLACK_WHITE_COLORS', 'WEDDING_DRESS_TRAIN', 'SEW_BUTTONS');
              
              INSERT INTO modifier_category_restrictions (modifier_id, category_code)
              SELECT id, 'LAUNDRY' FROM price_modifiers WHERE code IN ('WATER_REPELLENT', 'SILK_FABRIC');
              
              INSERT INTO modifier_category_restrictions (modifier_id, category_code)
              SELECT id, 'OTHER' FROM price_modifiers WHERE code IN ('LARGE_TOYS');
              
              -- Add category restrictions for leather modifiers
              INSERT INTO modifier_category_restrictions (modifier_id, category_code)
              SELECT id, 'LEATHER' FROM price_modifiers WHERE code IN ('IRON_LEATHER', 'LEATHER_WATER_REPELLENT', 'DYE_AFTER_OUR_CLEAN', 'DYE_AFTER_OTHER_CLEAN', 'LEATHER_WITH_INSERTS', 'PEARL_COATING', 'MANUAL_LEATHER');
              
              INSERT INTO modifier_category_restrictions (modifier_id, category_code)
              SELECT id, 'SHEEPSKIN' FROM price_modifiers WHERE code IN ('SHEEPSKIN_SYNTHETIC_FUR', 'LEATHER_WATER_REPELLENT', 'PEARL_COATING');
              
              -- Add excluded categories for discounts (discounts don't apply to these categories)
              INSERT INTO discount_excluded_categories (discount_id, category_code)
              SELECT id, 'LAUNDRY' FROM discounts WHERE code IN ('EVERCARD', 'SOCIAL_MEDIA', 'MILITARY');
              
              INSERT INTO discount_excluded_categories (discount_id, category_code)
              SELECT id, 'IRONING' FROM discounts WHERE code IN ('EVERCARD', 'SOCIAL_MEDIA', 'MILITARY');
              
              INSERT INTO discount_excluded_categories (discount_id, category_code)
              SELECT id, 'DYEING' FROM discounts WHERE code IN ('EVERCARD', 'SOCIAL_MEDIA', 'MILITARY');