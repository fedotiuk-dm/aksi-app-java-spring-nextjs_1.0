# Схеми відповідей для Order домену
OrderResponse:
  type: object
  title: OrderResponse
  required:
    - id
    - receiptNumber
    - uniqueTag
    - clientId
    - branchId
    - status
    - items
    - calculation
    - urgency
    - createdAt
    - updatedAt
  properties:
    id:
      $ref: "../../common/schemas/base.yaml#/UUID"
    receiptNumber:
      type: string
      description: Номер квитанції
      example: AKSI-2025-000123
    uniqueTag:
      type: string
      description: Унікальна мітка замовлення
    clientId:
      $ref: "../../common/schemas/base.yaml#/UUID"
    clientInfo:
      $ref: "#/ClientSummary"
    branchId:
      $ref: "../../common/schemas/base.yaml#/UUID"
    branchInfo:
      $ref: "#/BranchSummary"
    status:
      $ref: "../schemas/order-enums.yaml#/OrderStatus"
    items:
      type: array
      items:
        $ref: "#/OrderItemResponse"
    calculation:
      $ref: "#/OrderCalculationSummary"
    urgency:
      $ref: "../schemas/order-enums.yaml#/UrgencyType"
    executionDate:
      type: string
      format: date-time
      description: Дата виконання замовлення
    discount:
      $ref: "#/DiscountInfo"
    payment:
      $ref: "#/PaymentInfo"
    notes:
      type: string
      description: Примітки до замовлення
    clientSignature:
      type: string
      description: Цифровий підпис клієнта (base64)
    createdByUserId:
      $ref: "../../common/schemas/base.yaml#/UUID"
      description: ID користувача (оператора), який створив замовлення
    operatorName:
      type: string
      description: Ім'я оператора
  allOf:
    - $ref: "../../common/schemas/base.yaml#/TimestampProperties"

OrderListResponse:
  type: object
  title: OrderListResponse
  required:
    - items
  properties:
    items:
      type: array
      items:
        $ref: "#/OrderResponse"
      description: Список замовлень

OrderItemResponse:
  type: object
  title: OrderItemResponse
  required:
    - id
    - itemName
    - category
    - quantity
    - unit
    - material
    - color
    - basePrice
    - finalPrice
    - modifiers
    - calculation
    - photos
  properties:
    id:
      $ref: "../../common/schemas/base.yaml#/UUID"
    priceListItemId:
      $ref: "../../common/schemas/base.yaml#/UUID"
      description: ID послуги з прайс-листа
    itemName:
      type: string
      description: Найменування предмета
    category:
      type: string
      description: Категорія послуги
    quantity:
      type: integer
      description: Кількість
    unit:
      $ref: "../schemas/price-modifiers.yaml#/UnitType"
      description: Одиниця виміру
    material:
      type: string
      description: Матеріал виробу
    color:
      $ref: "../../item/schemas/item-enums.yaml#/ItemColor"
      description: Колір виробу (базовий колір)
    customColor:
      type: string
      description: Кастомний колір (має значення тільки якщо color = OTHER)
    filling:
      type: string
      description: Наповнювач
    wearDegree:
      type: integer
      description: Ступінь зносу у відсотках
    stains:
      type: array
      items:
        type: string
      description: Типи плям
    defects:
      type: array
      items:
        type: string
      description: Дефекти та ризики
    defectNotes:
      type: string
      description: Примітки щодо дефектів
    basePrice:
      type: number
      format: double
      description: Базова ціна
    modifiers:
      type: array
      items:
        $ref: "#/AppliedModifier"
      description: Застосовані модифікатори
    finalPrice:
      type: number
      format: double
      description: Фінальна ціна за предмет
    calculation:
      $ref: "#/ItemCalculationDetails"
    photos:
      type: array
      items:
        type: string
        format: uri
      description: URL фотографій предмета

ClientSummary:
  type: object
  title: ClientSummary
  required:
    - id
    - firstName
    - lastName
    - phone
  properties:
    id:
      $ref: "../../common/schemas/base.yaml#/UUID"
    firstName:
      type: string
    lastName:
      type: string
    phone:
      type: string

BranchSummary:
  type: object
  title: BranchSummary
  required:
    - id
    - name
    - address
  properties:
    id:
      $ref: "../../common/schemas/base.yaml#/UUID"
    name:
      type: string
    address:
      type: string

OrderCalculationSummary:
  type: object
  title: OrderCalculationSummary
  required:
    - itemsTotal
    - urgencyCharge
    - discountAmount
    - totalAmount
  properties:
    itemsTotal:
      type: number
      format: double
    urgencyCharge:
      type: number
      format: double
    discountAmount:
      type: number
      format: double
    totalAmount:
      type: number
      format: double

DiscountInfo:
  type: object
  title: DiscountInfo
  required:
    - type
    - percentage
    - amount
  properties:
    type:
      $ref: "../schemas/order-enums.yaml#/DiscountType"
    percentage:
      type: number
      format: double
    amount:
      type: number
      format: double
    description:
      type: string

PaymentInfo:
  type: object
  title: PaymentInfo
  required:
    - method
    - paidAmount
    - remainingAmount
  properties:
    method:
      $ref: "../schemas/order-enums.yaml#/PaymentMethod"
    paidAmount:
      type: number
      format: double
    remainingAmount:
      type: number
      format: double

AppliedModifier:
  type: object
  title: AppliedModifier
  required:
    - name
    - type
    - value
    - calculatedAmount
  properties:
    name:
      type: string
    type:
      $ref: "../schemas/order-enums.yaml#/ModifierType"
    value:
      type: number
      format: double
    calculatedAmount:
      type: number
      format: double

ItemCalculationDetails:
  type: object
  title: ItemCalculationDetails
  required:
    - basePrice
    - steps
    - finalPrice
  properties:
    basePrice:
      type: number
      format: double
    steps:
      type: array
      items:
        $ref: "#/CalculationStep"
    finalPrice:
      type: number
      format: double

CalculationStep:
  type: object
  title: CalculationStep
  required:
    - step
    - description
    - formula
    - amount
    - subtotal
  properties:
    step:
      type: integer
    description:
      type: string
    formula:
      type: string
    amount:
      type: number
      format: double
    subtotal:
      type: number
      format: double

# Page Responses
OrderPageResponse:
  type: object
  title: OrderPageResponse
  required:
    - content
    - pageable
    - totalElements
    - totalPages
    - last
    - first
    - numberOfElements
  properties:
    content:
      type: array
      items:
        $ref: "#/OrderResponse"
    pageable:
      $ref: "../../common/schemas/pagination.yaml#/PageableInfo"
    totalElements:
      type: integer
      format: int64
    totalPages:
      type: integer
    last:
      type: boolean
    first:
      type: boolean
    numberOfElements:
      type: integer

