openapi: 3.0.3
info:
  title: Item Domain API
  description: API для управління предметами, послугами та розрахунками в односторінковій
    системі хімчистки
  version: 1.0.0
  contact:
    name: AKSI Development Team
    email: dev@aksi.com
servers:
- url: http://localhost:8080
  description: Development server
- url: https://api.aksi.com
  description: Production server
tags:
- name: service-categories
  description: Категорії послуг
- name: price-list
  description: Прайс-лист предметів
- name: item-characteristics
  description: Характеристики предметів
- name: price-modifiers
  description: Модифікатори цін
- name: price-calculator
  description: Калькулятор цін
- name: photo-management
  description: Управління фотографіями
paths:
  /api/service-categories:
    get:
      tags:
      - service-categories
      summary: Отримати список категорій послуг
      description: Повертає ієрархічний список всіх категорій послуг хімчистки
      parameters:
      - name: active
        in: query
        description: Фільтр за активними категоріями
        required: false
        schema:
          type: boolean
          default: true
      - name: includeInactive
        in: query
        description: Включити неактивні категорії
        required: false
        schema:
          type: boolean
          default: false
      responses:
        '200':
          description: Список категорій послуг
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ServiceCategoryResponse'
      operationId: getServiceCategories
  /api/service-categories/{id}:
    get:
      tags:
      - service-categories
      summary: Отримати категорію за ID
      description: Повертає детальну інформацію про категорію послуг
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор категорії (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Інформація про категорію
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceCategoryResponse'
        '404':
          description: Категорія не знайдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getServiceCategoriebyid
  /api/service-categories/{id}/items:
    get:
      tags:
      - price-list
      summary: Отримати предмети категорії
      description: Повертає прайс-лист предметів для конкретної категорії
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор категорії (UUID)
        schema:
          type: string
          format: uuid
      - name: active
        in: query
        description: Фільтр за активними предметами
        required: false
        schema:
          type: boolean
          default: true
      responses:
        '200':
          description: Список предметів категорії
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PriceListItemResponse'
        '404':
          description: Категорія не знайдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getServiceCategoriebyid1
  /api/price-list:
    get:
      tags:
      - price-list
      summary: Отримати повний прайс-лист
      description: Повертає повний прайс-лист з можливістю фільтрації та пошуку
      parameters:
      - name: search
        in: query
        description: Пошук за назвою предмета
        required: false
        schema:
          type: string
      - name: categoryId
        in: query
        description: Фільтр за категорією
        required: false
        schema:
          type: string
          format: uuid
      - name: active
        in: query
        description: Тільки активні предмети
        required: false
        schema:
          type: boolean
          default: true
      - name: page
        in: query
        description: Номер сторінки
        required: false
        schema:
          type: integer
          minimum: 0
          default: 0
      - name: size
        in: query
        description: Розмір сторінки
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      responses:
        '200':
          description: Прайс-лист предметів
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceListPageResponse'
      operationId: getPriceList
  /api/price-list/{id}:
    get:
      tags:
      - price-list
      summary: Отримати предмет прайс-листа
      description: Повертає детальну інформацію про предмет з прайс-листа
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор предмета (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Інформація про предмет
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceListItemResponse'
        '404':
          description: Предмет не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getPriceListbyid
  /api/materials:
    get:
      tags:
      - item-characteristics
      summary: Отримати список матеріалів
      description: Повертає список доступних матеріалів для конкретної категорії
      parameters:
      - name: categoryId
        in: query
        description: Фільтр за категорією послуг
        required: false
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Список матеріалів
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MaterialOption'
      operationId: getMaterials
  /api/colors:
    get:
      tags:
      - item-characteristics
      summary: Отримати список кольорів
      description: Повертає список базових кольорів для швидкого вибору
      responses:
        '200':
          description: Список кольорів
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ColorOption'
      operationId: getColors
  /api/fillings:
    get:
      tags:
      - item-characteristics
      summary: Отримати список наповнювачів
      description: Повертає список доступних наповнювачів
      responses:
        '200':
          description: Список наповнювачів
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FillingOption'
      operationId: getFillings
  /api/stains:
    get:
      tags:
      - item-characteristics
      summary: Отримати типи плям
      description: Повертає каталог типів плям
      responses:
        '200':
          description: Каталог плям
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StainType'
      operationId: getStains
  /api/defects:
    get:
      tags:
      - item-characteristics
      summary: Отримати типи дефектів
      description: Повертає каталог дефектів та ризиків
      responses:
        '200':
          description: Каталог дефектів
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DefectType'
      operationId: getDefects
  /api/price-modifiers:
    get:
      tags:
      - price-modifiers
      summary: Отримати список модифікаторів цін
      description: Повертає список доступних модифікаторів для конкретної категорії
      parameters:
      - name: categoryId
        in: query
        description: Фільтр за категорією послуг
        required: false
        schema:
          type: string
          format: uuid
      - name: type
        in: query
        description: Тип модифікатора
        required: false
        schema:
          $ref: '#/components/schemas/ModifierType'
      - name: active
        in: query
        description: Тільки активні модифікатори
        required: false
        schema:
          type: boolean
          default: true
      responses:
        '200':
          description: Список модифікаторів
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PriceModifierResponse'
      operationId: getPriceModifiers
  /api/price-modifiers/{id}:
    get:
      tags:
      - price-modifiers
      summary: Отримати модифікатор за ID
      description: Повертає детальну інформацію про модифікатор ціни
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор модифікатора (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Інформація про модифікатор
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceModifierResponse'
        '404':
          description: Модифікатор не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getPriceModifierbyid
  /api/calculate/item:
    post:
      tags:
      - price-calculator
      summary: Розрахувати ціну предмета
      description: Розраховує ціну предмета з усіма модифікаторами (інтерактивний
        калькулятор)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemCalculationRequest'
      responses:
        '200':
          description: Розрахунок ціни предмета
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemCalculationResponse'
        '400':
          description: Помилка валідації параметрів
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
      operationId: createCalculate
  /api/calculate/item/preview:
    post:
      tags:
      - price-calculator
      summary: Попередній розрахунок ціни
      description: Швидкий розрахунок без збереження (для real-time калькулятора)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ItemCalculationRequest'
      responses:
        '200':
          description: Попередній розрахунок
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemCalculationResponse'
        '400':
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
      operationId: createCalculate2
  /api/photos:
    post:
      tags:
      - photo-management
      summary: Завантажити фотографію
      description: Завантажує фотографію предмета (максимум 5MB)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
              - file
              - itemId
              properties:
                file:
                  type: string
                  format: binary
                  description: Файл зображення
                itemId:
                  type: string
                  format: uuid
                  description: Ідентифікатор предмета
                description:
                  type: string
                  maxLength: 200
                  description: Опис фотографії
      responses:
        '201':
          description: Фотографія успішно завантажена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhotoResponse'
        '400':
          description: Помилка валідації або розмір файлу
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '413':
          description: Файл занадто великий (максимум 5MB)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: createPhoto
  /api/photos/{id}:
    get:
      tags:
      - photo-management
      summary: Отримати фотографію
      description: Повертає фотографію за ID
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор фотографії (UUID)
        schema:
          type: string
          format: uuid
      - name: size
        in: query
        description: Розмір зображення
        required: false
        schema:
          type: string
          enum:
          - thumbnail
          - medium
          - full
          default: medium
      responses:
        '200':
          description: Фотографія
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
        '404':
          description: Фотографія не знайдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getPhotoById
    delete:
      tags:
      - photo-management
      summary: Видалити фотографію
      description: Видаляє фотографію предмета
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор фотографії (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '204':
          description: Фотографія успішно видалена
        '404':
          description: Фотографія не знайдена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: deletePhoto
  /api/photos/item/{itemId}:
    get:
      tags:
      - photo-management
      summary: Отримати фотографії предмета
      description: Повертає всі фотографії конкретного предмета
      parameters:
      - name: itemId
        in: path
        required: true
        description: Унікальний ідентифікатор предмета (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Список фотографій предмета
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PhotoResponse'
        '404':
          description: Предмет не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getPhotos
components:
  schemas:
    ItemCalculationRequest:
      type: object
      required:
      - priceListItemId
      - quantity
      - characteristics
      properties:
        priceListItemId:
          type: string
          format: uuid
          description: Ідентифікатор предмета з прайс-листа
        quantity:
          type: integer
          minimum: 1
          description: Кількість предметів
        characteristics:
          $ref: '#/components/schemas/ItemCharacteristicsRequest'
        modifiers:
          type: array
          items:
            type: string
            format: uuid
          description: Список ідентифікаторів застосованих модифікаторів
        urgency:
          type: string
          enum:
          - NORMAL
          - URGENT_48H
          - URGENT_24H
          description: Терміновість виконання
          default: NORMAL
    ItemCharacteristicsRequest:
      type: object
      required:
      - material
      - color
      properties:
        material:
          type: string
          maxLength: 50
          description: Матеріал виробу
        color:
          type: string
          maxLength: 50
          description: Колір виробу
        filling:
          type: string
          maxLength: 50
          description: Наповнювач
        wearDegree:
          type: integer
          minimum: 10
          maximum: 75
          description: Ступінь зносу у відсотках
        stains:
          type: array
          items:
            type: string
            enum:
            - FAT
            - BLOOD
            - PROTEIN
            - WINE
            - COFFEE
            - GRASS
            - INK
            - COSMETICS
            - OTHER
          description: Типи плям
        customStain:
          type: string
          maxLength: 100
          description: Опис кастомної плями (якщо вибрано OTHER)
        defects:
          type: array
          items:
            type: string
            enum:
            - WORN
            - TORN
            - MISSING_HARDWARE
            - DAMAGED_HARDWARE
            - COLOR_CHANGE_RISK
            - DEFORMATION_RISK
            - NO_GUARANTEE
          description: Дефекти та ризики
        defectNotes:
          type: string
          maxLength: 500
          description: Примітки щодо дефектів
        hasRisks:
          type: boolean
          description: Наявність ризиків
        riskDescription:
          type: string
          maxLength: 500
          description: Опис ризиків
    ServiceCategoryResponse:
      type: object
      required:
      - id
      - code
      - name
      - standardDays
      - isActive
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор категорії
        code:
          type: string
          description: Унікальний код категорії
          example: TEXTILE_CLEANING
        name:
          type: string
          description: Назва категорії
          example: Чистка одягу та текстилю
        description:
          type: string
          description: Опис категорії
        parentId:
          type: string
          format: uuid
          description: Ідентифікатор батьківської категорії
        standardDays:
          type: integer
          description: Стандартний термін виконання в днях
          example: 2
        isActive:
          type: boolean
          description: Чи активна категорія
        availableMaterials:
          type: array
          items:
            type: string
          description: Доступні матеріали для категорії
        availableModifiers:
          type: array
          items:
            type: string
            format: uuid
          description: Доступні модифікатори для категорії
        itemsCount:
          type: integer
          description: Кількість предметів в категорії
    PriceListItemResponse:
      type: object
      required:
      - id
      - categoryId
      - itemNumber
      - name
      - unit
      - basePrice
      - isActive
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор предмета
        categoryId:
          type: string
          format: uuid
          description: Ідентифікатор категорії
        categoryInfo:
          $ref: '#/components/schemas/ServiceCategorySummary'
        itemNumber:
          type: integer
          description: Номер предмета в каталозі
          example: 101
        name:
          type: string
          description: Назва предмета
          example: Костюм чоловічий
        unit:
          type: string
          enum:
          - PIECE
          - KILOGRAM
          description: Одиниця виміру
        basePrice:
          type: number
          format: double
          description: Базова ціна
          example: 150.0
        blackPrice:
          type: number
          format: double
          description: Ціна для чорних речей
          example: 180.0
        lightPrice:
          type: number
          format: double
          description: Ціна для світлих речей
          example: 150.0
        isActive:
          type: boolean
          description: Чи активний предмет
        notes:
          type: string
          description: Примітки до предмета
    PriceModifierResponse:
      type: object
      required:
      - id
      - code
      - name
      - type
      - value
      - isActive
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор модифікатора
        code:
          type: string
          description: Унікальний код модифікатора
          example: CHILDREN_ITEMS
        name:
          type: string
          description: Назва модифікатора
          example: Дитячі речі (до 30 розміру)
        type:
          $ref: '#/components/schemas/ModifierType'
        value:
          type: number
          format: double
          description: Значення модифікатора
          example: 30.0
        applicableTo:
          type: array
          items:
            type: string
            format: uuid
          description: Категорії, до яких застосовується
        isActive:
          type: boolean
          description: Чи активний модифікатор
        description:
          type: string
          description: Опис модифікатора
    ItemCalculationResponse:
      type: object
      properties:
        priceListItemId:
          type: string
          format: uuid
        itemName:
          type: string
        quantity:
          type: integer
        basePrice:
          type: number
          format: double
          description: Базова ціна за одиницю
        totalBasePrice:
          type: number
          format: double
          description: Базова ціна за кількість
        appliedModifiers:
          type: array
          items:
            $ref: '#/components/schemas/AppliedModifierResult'
          description: Застосовані модифікатори
        modifiersTotal:
          type: number
          format: double
          description: Загальна сума модифікаторів
        subtotal:
          type: number
          format: double
          description: Проміжна сума
        urgencyCharge:
          type: number
          format: double
          description: Надбавка за терміновість
        finalPrice:
          type: number
          format: double
          description: Фінальна ціна
        calculationSteps:
          type: array
          items:
            $ref: '#/components/schemas/CalculationStep'
          description: Детальні кроки розрахунку
        warnings:
          type: array
          items:
            type: string
          description: Попередження щодо розрахунку
    PhotoResponse:
      type: object
      required:
      - id
      - itemId
      - filename
      - url
      - uploadedAt
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор фотографії
        itemId:
          type: string
          format: uuid
          description: Ідентифікатор предмета
        filename:
          type: string
          description: Ім'я файлу
        originalFilename:
          type: string
          description: Оригінальне ім'я файлу
        url:
          type: string
          format: uri
          description: URL для доступу до фотографії
        thumbnailUrl:
          type: string
          format: uri
          description: URL мініатюри
        fileSize:
          type: integer
          format: int64
          description: Розмір файлу в байтах
        mimeType:
          type: string
          description: MIME тип файлу
          example: image/jpeg
        description:
          type: string
          description: Опис фотографії
        uploadedAt:
          type: string
          format: date-time
          description: Дата завантаження
    PriceListPageResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/PriceListItemResponse'
        pageable:
          $ref: '#/components/schemas/PageableInfo'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        last:
          type: boolean
        first:
          type: boolean
        numberOfElements:
          type: integer
    ServiceCategorySummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        code:
          type: string
        name:
          type: string
        standardDays:
          type: integer
    AppliedModifierResult:
      type: object
      properties:
        modifierId:
          type: string
          format: uuid
        name:
          type: string
        type:
          $ref: '#/components/schemas/ModifierType'
        value:
          type: number
          format: double
        appliedAmount:
          type: number
          format: double
        description:
          type: string
    CalculationStep:
      type: object
      properties:
        step:
          type: string
          description: Назва кроку
        description:
          type: string
          description: Опис кроку
        amount:
          type: number
          format: double
          description: Сума на цьому кроці
        runningTotal:
          type: number
          format: double
          description: Накопичена сума
    MaterialOption:
      type: object
      properties:
        code:
          type: string
          example: WOOL
        name:
          type: string
          example: Шерсть
        applicableCategories:
          type: array
          items:
            type: string
            format: uuid
    ColorOption:
      type: object
      properties:
        code:
          type: string
          example: BLACK
        name:
          type: string
          example: Чорний
        hexCode:
          type: string
          example: '#000000'
        affectsPrice:
          type: boolean
          description: Чи впливає колір на ціну
    FillingOption:
      type: object
      properties:
        code:
          type: string
          example: DOWN
        name:
          type: string
          example: Пух
        description:
          type: string
    StainType:
      type: object
      properties:
        code:
          type: string
          example: FAT
        name:
          type: string
          example: Жир
        description:
          type: string
        severity:
          type: string
          enum:
          - LOW
          - MEDIUM
          - HIGH
        affectsPrice:
          type: boolean
    DefectType:
      type: object
      properties:
        code:
          type: string
          example: WORN
        name:
          type: string
          example: Потертості
        description:
          type: string
        riskLevel:
          type: string
          enum:
          - LOW
          - MEDIUM
          - HIGH
          - CRITICAL
        requiresNotes:
          type: boolean
        affectsWarranty:
          type: boolean
    PageableInfo:
      type: object
      properties:
        page:
          type: integer
        size:
          type: integer
        sort:
          type: array
          items:
            type: string
    ModifierType:
      type: string
      enum:
      - PERCENTAGE
      - FIXED_AMOUNT
      - MULTIPLIER
      - REPLACEMENT
      description: 'Типи модифікаторів ціни:

        * PERCENTAGE - Відсотковий (+20%)

        * FIXED_AMOUNT - Фіксована сума (+50 грн)

        * MULTIPLIER - Множник (x1.5)

        * REPLACEMENT - Заміна базової ціни

        '
    ErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string
    ValidationErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string
        validationErrors:
          type: array
          items:
            $ref: '#/components/schemas/FieldError'
    FieldError:
      type: object
      properties:
        field:
          type: string
        message:
          type: string
        rejectedValue:
          description: Значення, яке було відхилено
        code:
          type: string
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
