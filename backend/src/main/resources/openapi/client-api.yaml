openapi: 3.0.3
info:
  title: Client Domain API
  description: API для управління клієнтами хімчистки
  version: 1.0.0
  contact:
    name: AKSI Development Team
    email: dev@aksi.com
servers:
- url: http://localhost:8080
  description: Development server
- url: https://api.aksi.com
  description: Production server
tags:
- name: clients
  description: Управління клієнтами
- name: client-search
  description: Пошук клієнтів
- name: client-contacts
  description: Контактна інформація
paths:
  /api/clients:
    get:
      tags:
      - clients
      summary: Отримати список клієнтів
      description: Повертає список всіх клієнтів з можливістю пагінації
      parameters:
      - name: page
        in: query
        description: Номер сторінки (починаючи з 0)
        required: false
        schema:
          type: integer
          minimum: 0
          default: 0
      - name: size
        in: query
        description: Розмір сторінки
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: sort
        in: query
        description: Поле для сортування
        required: false
        schema:
          type: string
          enum:
          - firstName
          - lastName
          - phone
          - createdAt
          default: lastName
      responses:
        '200':
          description: Список клієнтів
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientPageResponse'
        '400':
          description: Некоректні параметри запиту
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getClients
    post:
      tags:
      - clients
      summary: Створити нового клієнта
      description: Створює нового клієнта хімчистки
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateClientRequest'
      responses:
        '201':
          description: Клієнт успішно створений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientResponse'
        '400':
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '409':
          description: Клієнт з таким телефоном вже існує
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: createClient
  /api/clients/{id}:
    get:
      tags:
      - clients
      summary: Отримати клієнта за ID
      description: Повертає детальну інформацію про конкретного клієнта
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор клієнта (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Інформація про клієнта
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientResponse'
        '404':
          description: Клієнт не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getClientById
    put:
      tags:
      - clients
      summary: Оновити інформацію про клієнта
      description: Оновлює існуючого клієнта
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор клієнта (UUID)
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateClientRequest'
      responses:
        '200':
          description: Клієнт успішно оновлений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientResponse'
        '400':
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '404':
          description: Клієнт не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: updateClient
    delete:
      tags:
      - clients
      summary: Видалити клієнта
      description: Видаляє клієнта (м'яке видалення)
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор клієнта (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '204':
          description: Клієнт успішно видалений
        '404':
          description: Клієнт не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: deleteClient
  /api/clients/search:
    get:
      tags:
      - client-search
      summary: Пошук клієнтів
      description: Швидкий пошук клієнтів за різними критеріями з автозаповненням
      parameters:
      - name: query
        in: query
        required: true
        description: Пошуковий запит (ім'я, прізвище, телефон, email)
        schema:
          type: string
          minLength: 2
          maxLength: 100
      - name: limit
        in: query
        description: Максимальна кількість результатів (для автозаповнення)
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 50
          default: 10
      responses:
        '200':
          description: Результати пошуку
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientSearchResponse'
        '400':
          description: Некоректний пошуковий запит
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: searchClients
  /api/clients/search/advanced:
    post:
      tags:
      - client-search
      summary: Розширений пошук клієнтів
      description: Розширений пошук з фільтрами та сортуванням
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClientSearchRequest'
      responses:
        '200':
          description: Результати розширеного пошуку
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientPageResponse'
        '400':
          description: Некоректні параметри пошуку
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
      operationId: advancedSearchClients
  /api/clients/{id}/contacts:
    get:
      tags:
      - client-contacts
      summary: Отримати контактну інформацію клієнта
      description: Повертає всю контактну інформацію клієнта
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор клієнта (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Контактна інформація клієнта
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientContactsResponse'
        '404':
          description: Клієнт не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getClientContacts
    put:
      tags:
      - client-contacts
      summary: Оновити контактну інформацію клієнта
      description: Оновлює контактну інформацію існуючого клієнта
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор клієнта (UUID)
        schema:
          type: string
          format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateClientContactsRequest'
      responses:
        '200':
          description: Контактна інформація успішно оновлена
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientContactsResponse'
        '400':
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '404':
          description: Клієнт не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: updateClientContacts
  /api/clients/{id}/statistics:
    get:
      tags:
      - clients
      summary: Отримати статистику клієнта
      description: Повертає статистику замовлень та витрат клієнта
      parameters:
      - name: id
        in: path
        required: true
        description: Унікальний ідентифікатор клієнта (UUID)
        schema:
          type: string
          format: uuid
      responses:
        '200':
          description: Статистика клієнта
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientStatistics'
        '404':
          description: Клієнт не знайдений
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      operationId: getClientStatistics
components:
  schemas:
    CreateClientRequest:
      type: object
      required:
      - firstName
      - lastName
      - phone
      properties:
        firstName:
          type: string
          minLength: 2
          maxLength: 50
          description: Ім'я клієнта
          example: Олександр
        lastName:
          type: string
          minLength: 2
          maxLength: 50
          description: Прізвище клієнта
          example: Петренко
        phone:
          type: string
          pattern: ^\+380\d{9}$
          description: Номер телефону в міжнародному форматі
          example: '+380501234567'
        email:
          type: string
          format: email
          maxLength: 100
          description: Email адреса (опціонально)
          example: oleksandr.petrenko@example.com
        address:
          $ref: '#/components/schemas/CreateAddressRequest'
        communicationMethods:
          type: array
          items:
            $ref: '#/components/schemas/CommunicationMethod'
          description: Бажані способи зв'язку
          example:
          - PHONE
          - SMS
          - VIBER
        sourceType:
          $ref: '#/components/schemas/ClientSourceType'
          description: Джерело надходження клієнта
        notes:
          type: string
          maxLength: 500
          description: Додаткові примітки про клієнта
    UpdateClientRequest:
      type: object
      properties:
        firstName:
          type: string
          minLength: 2
          maxLength: 50
          description: Ім'я клієнта
        lastName:
          type: string
          minLength: 2
          maxLength: 50
          description: Прізвище клієнта
        phone:
          type: string
          pattern: ^\+380\d{9}$
          description: Номер телефону в міжнародному форматі
        email:
          type: string
          format: email
          maxLength: 100
          description: Email адреса
        address:
          $ref: '#/components/schemas/UpdateAddressRequest'
        communicationMethods:
          type: array
          items:
            $ref: '#/components/schemas/CommunicationMethod'
          description: Бажані способи зв'язку
        sourceType:
          $ref: '#/components/schemas/ClientSourceType'
        notes:
          type: string
          maxLength: 500
          description: Додаткові примітки про клієнта
    CreateAddressRequest:
      type: object
      properties:
        street:
          type: string
          maxLength: 200
          description: Вулиця та номер будинку
          example: вул. Хрещатик, 1
        city:
          type: string
          maxLength: 100
          description: Місто
          example: Київ
        region:
          type: string
          maxLength: 100
          description: Область/регіон
          example: Київська область
        postalCode:
          type: string
          maxLength: 10
          description: Поштовий індекс
          example: '01001'
        country:
          type: string
          maxLength: 100
          description: Країна
          default: Україна
    UpdateAddressRequest:
      type: object
      properties:
        street:
          type: string
          maxLength: 200
          description: Вулиця та номер будинку
        city:
          type: string
          maxLength: 100
          description: Місто
        region:
          type: string
          maxLength: 100
          description: Область/регіон
        postalCode:
          type: string
          maxLength: 10
          description: Поштовий індекс
        country:
          type: string
          maxLength: 100
          description: Країна
    ClientSearchRequest:
      type: object
      properties:
        query:
          type: string
          minLength: 2
          maxLength: 100
          description: Загальний пошуковий запит
        firstName:
          type: string
          maxLength: 50
          description: Фільтр за ім'ям
        lastName:
          type: string
          maxLength: 50
          description: Фільтр за прізвищем
        phone:
          type: string
          description: Фільтр за телефоном
        email:
          type: string
          description: Фільтр за email
        city:
          type: string
          maxLength: 100
          description: Фільтр за містом
        sourceType:
          $ref: '#/components/schemas/ClientSourceType'
        communicationMethods:
          type: array
          items:
            $ref: '#/components/schemas/CommunicationMethod'
        registrationDateFrom:
          type: string
          format: date
          description: Дата реєстрації (від)
        registrationDateTo:
          type: string
          format: date
          description: Дата реєстрації (до)
        isVip:
          type: boolean
          description: Фільтр VIP клієнтів
        page:
          type: integer
          minimum: 0
          default: 0
          description: Номер сторінки
        size:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Розмір сторінки
        sort:
          type: string
          enum:
          - firstName
          - lastName
          - phone
          - createdAt
          - totalOrders
          - totalSpent
          default: lastName
          description: Поле для сортування
    UpdateClientContactsRequest:
      type: object
      properties:
        phone:
          type: string
          pattern: ^\+380\d{9}$
          description: Номер телефону
        email:
          type: string
          format: email
          maxLength: 100
          description: Email адреса
        communicationMethods:
          type: array
          items:
            $ref: '#/components/schemas/CommunicationMethod'
          description: Бажані способи зв'язку
        address:
          $ref: '#/components/schemas/UpdateAddressRequest'
    ClientResponse:
      type: object
      required:
      - id
      - firstName
      - lastName
      - phone
      - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор клієнта
        firstName:
          type: string
          description: Ім'я клієнта
        lastName:
          type: string
          description: Прізвище клієнта
        fullName:
          type: string
          description: Повне ім'я (firstName + lastName)
          readOnly: true
        phone:
          type: string
          description: Номер телефону
        email:
          type: string
          description: Email адреса
        address:
          $ref: '#/components/schemas/AddressDto'
        communicationMethods:
          type: array
          items:
            $ref: '#/components/schemas/CommunicationMethod'
        sourceType:
          $ref: '#/components/schemas/ClientSourceType'
        notes:
          type: string
          description: Примітки
        statistics:
          $ref: '#/components/schemas/ClientStatistics'
        createdAt:
          type: string
          format: date-time
          description: Дата створення
        updatedAt:
          type: string
          format: date-time
          description: Дата останнього оновлення
    ClientPageResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/ClientResponse'
        pageable:
          $ref: '#/components/schemas/PageableInfo'
        totalElements:
          type: integer
          format: int64
          description: Загальна кількість елементів
        totalPages:
          type: integer
          description: Загальна кількість сторінок
        last:
          type: boolean
          description: Чи це остання сторінка
        first:
          type: boolean
          description: Чи це перша сторінка
        numberOfElements:
          type: integer
          description: Кількість елементів на поточній сторінці
    ClientSearchResponse:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/ClientSearchResult'
        totalFound:
          type: integer
          description: Загальна кількість знайдених результатів
        hasMore:
          type: boolean
          description: Чи є ще результати
    ClientSearchResult:
      type: object
      properties:
        id:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        fullName:
          type: string
          readOnly: true
        phone:
          type: string
        email:
          type: string
        lastOrderDate:
          type: string
          format: date
          description: Дата останнього замовлення
        orderCount:
          type: integer
          description: Кількість замовлень
        highlightedFields:
          type: array
          items:
            type: string
          description: Поля, які відповідають пошуковому запиту
    ClientContactsResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        phone:
          type: string
          description: Номер телефону
        email:
          type: string
          description: Email адреса
        communicationMethods:
          type: array
          items:
            $ref: '#/components/schemas/CommunicationMethod'
        address:
          $ref: '#/components/schemas/AddressDto'
    AddressDto:
      type: object
      properties:
        street:
          type: string
          maxLength: 200
          description: Вулиця та номер будинку
          example: вул. Хрещатик, 1
        city:
          type: string
          maxLength: 100
          description: Місто
          example: Київ
        region:
          type: string
          maxLength: 100
          description: Область/регіон
          example: Київська область
        postalCode:
          type: string
          maxLength: 10
          description: Поштовий індекс
          example: '01001'
        country:
          type: string
          maxLength: 100
          description: Країна
          default: Україна
    ClientStatistics:
      type: object
      properties:
        totalOrders:
          type: integer
          description: Загальна кількість замовлень
        totalSpent:
          type: number
          format: double
          description: Загальна сума витрат
        lastOrderDate:
          type: string
          format: date
          description: Дата останнього замовлення
        averageOrderValue:
          type: number
          format: double
          description: Середня вартість замовлення
        isVip:
          type: boolean
          description: Чи є клієнт VIP
        registrationDate:
          type: string
          format: date
          description: Дата першого замовлення
    PageableInfo:
      type: object
      properties:
        page:
          type: integer
          description: Номер поточної сторінки
        size:
          type: integer
          description: Розмір сторінки
        sort:
          type: array
          items:
            type: string
          description: Критерії сортування
    CommunicationMethod:
      type: string
      enum:
      - PHONE
      - SMS
      - VIBER
      - TELEGRAM
      - EMAIL
      description: 'Способи зв''язку з клієнтом:

        * PHONE - Телефонний дзвінок

        * SMS - SMS повідомлення

        * VIBER - Viber месенджер

        * TELEGRAM - Telegram месенджер

        * EMAIL - Електронна пошта

        '
    ClientSourceType:
      type: string
      enum:
      - REFERRAL
      - ADVERTISING
      - SOCIAL_MEDIA
      - WEBSITE
      - WALKING_BY
      - REPEAT_CUSTOMER
      - OTHER
      description: 'Джерело надходження клієнта:

        * REFERRAL - Рекомендація

        * ADVERTISING - Реклама

        * SOCIAL_MEDIA - Соціальні мережі

        * WEBSITE - Веб-сайт

        * WALKING_BY - Проходив повз

        * REPEAT_CUSTOMER - Постійний клієнт

        * OTHER - Інше

        '
    ErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
          description: Час виникнення помилки
        status:
          type: integer
          description: HTTP статус код
        error:
          type: string
          description: Тип помилки
        message:
          type: string
          description: Повідомлення про помилку
        path:
          type: string
          description: Шлях запиту, де виникла помилка
    ValidationErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string
        validationErrors:
          type: array
          items:
            $ref: '#/components/schemas/FieldError'
    FieldError:
      type: object
      properties:
        field:
          type: string
          description: Назва поля з помилкою
        message:
          type: string
          description: Повідомлення про помилку
        rejectedValue:
          description: Значення, яке було відхилено
        code:
          type: string
          description: Код помилки валідації
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
security:
- BearerAuth: []
