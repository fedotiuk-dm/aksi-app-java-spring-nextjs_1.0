---
paths:
  /api/auth/security/attempts:
    get:
      operationId: getSecurityAttempts
      summary: Get login attempt statistics
      description: Get rate limiting and security attempt statistics (admin only)
      tags:
        - security
      security:
        - cookieAuth: []
        - bearerAuth: []
      responses:
        "200":
          description: Security attempt statistics
          content:
            application/json:
              schema:
                $ref: "../schemas/security-schemas.yaml#/components/schemas/SecurityAttemptsResponse"
        "401":
          $ref: "../../common.yaml#/components/responses/Unauthorized"
        "403":
          $ref: "../../common.yaml#/components/responses/Forbidden"
        "429":
          $ref: "../../common.yaml#/components/responses/TooManyRequests"

  /api/auth/security/unlock/[username]:
    post:
      operationId: unlockUser
      summary: Unlock blocked user
      description: Clear failed login attempts and unlock blocked user (admin only)
      tags:
        - security
      security:
        - cookieAuth: []
        - bearerAuth: []
      parameters:
        - name: username
          in: path
          required: true
          description: Username to unlock
          schema:
            type: string
            pattern: "^[a-zA-Z0-9\\s.,!?-]{1,255}$"
      responses:
        "200":
          description: User unlocked successfully
        "401":
          $ref: "../../common.yaml#/components/responses/Unauthorized"
        "403":
          $ref: "../../common.yaml#/components/responses/Forbidden"
        "404":
          $ref: "../../common.yaml#/components/responses/NotFound"

  /api/auth/security/unlock-ip/[ipAddress]:
    post:
      operationId: unlockIp
      summary: Unlock IP address
      description: Clear failed login attempts and unlock blocked IP address (admin only)
      tags:
        - security
      security:
        - cookieAuth: []
        - bearerAuth: []
      parameters:
        - name: ipAddress
          in: path
          required: true
          description: IP address to unlock
          schema:
            type: string
            pattern: "^[a-zA-Z0-9\\s.,!?-]{1,255}$"
      responses:
        "200":
          description: IP address unlocked successfully
        "401":
          $ref: "../../common.yaml#/components/responses/Unauthorized"
        "403":
          $ref: "../../common.yaml#/components/responses/Forbidden"

  /api/auth/security/policy:
    get:
      operationId: getSecurityPolicy
      summary: Get current security policy
      description: Get current security policy settings (rate limits, password policy, etc.)
      tags:
        - security
      security:
        - cookieAuth: []
        - bearerAuth: []
      responses:
        "200":
          description: Current security policy
          content:
            application/json:
              schema:
                $ref: "../schemas/security-schemas.yaml#/components/schemas/SecurityPolicyResponse"
        "401":
          $ref: "../../common.yaml#/components/responses/Unauthorized"
        "429":
          $ref: "../../common.yaml#/components/responses/TooManyRequests"
