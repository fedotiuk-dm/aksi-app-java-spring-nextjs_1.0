# Endpoints для управління цифровими підписами
/api/digital-signatures:
  post:
    tags:
      - digital-signatures
    summary: Створити цифровий підпис
    description: Зберігає цифровий підпис клієнта або оператора
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schemas/document-requests.yaml#/CreateDigitalSignatureRequest"
    responses:
      201:
        description: Підпис успішно збережено
        content:
          application/json:
            schema:
              $ref: "../schemas/document-responses.yaml#/DigitalSignatureResponse"
      400:
        description: Помилка валідації
        content:
          application/json:
            schema:
              $ref: "../../common/schemas/errors.yaml#/ValidationErrorResponse"
    operationId: createDigitalSignature

/api/digital-signatures/{id}:
  get:
    tags:
      - digital-signatures
    summary: Отримати цифровий підпис
    description: Повертає інформацію про цифровий підпис
    parameters:
      - $ref: "../../common/parameters/path.yaml#/IdParam"
    responses:
      200:
        description: Інформація про підпис
        content:
          application/json:
            schema:
              $ref: "../schemas/document-responses.yaml#/DigitalSignatureResponse"
      404:
        description: Підпис не знайдений
        content:
          application/json:
            schema:
              $ref: "../../common/schemas/errors.yaml#/ErrorResponse"
    operationId: getDigitalSignatureById

/api/digital-signatures/{id}/image:
  get:
    tags:
      - digital-signatures
    summary: Отримати зображення підпису
    description: Повертає зображення цифрового підпису
    parameters:
      - $ref: "../../common/parameters/path.yaml#/IdParam"
      - name: format
        in: query
        description: Формат зображення
        required: false
        schema:
          type: string
          enum:
            - PNG
            - SVG
          default: PNG
    responses:
      200:
        description: Зображення підпису
        content:
          image/png:
            schema:
              type: string
              format: binary
            example: "[Binary PNG signature data]"
          image/svg+xml:
            schema:
              type: string
            example: "<svg><path d='M10,10 L20,20'></path></svg>"
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                  description: URL для завантаження зображення підпису
                format:
                  type: string
                  enum: [PNG, SVG]
                  description: Формат зображення
                filename:
                  type: string
                  description: Ім'я файлу для завантаження
                size:
                  type: integer
                  description: Розмір файлу в байтах
                dimensions:
                  type: object
                  properties:
                    width:
                      type: integer
                    height:
                      type: integer
              example:
                url: "http://localhost:8080/api/digital-signatures/550e8400-e29b-41d4-a716-446655440000/image?format=PNG"
                format: "PNG"
                filename: "signature-550e8400-e29b-41d4-a716-446655440000.png"
                size: 5120
                dimensions:
                  width: 200
                  height: 100
        headers:
          Content-Disposition:
            description: Attachment filename
            schema:
              type: string
              example: attachment; filename="signature-550e8400-e29b-41d4-a716-446655440000.png"
      404:
        description: Підпис не знайдений
        content:
          application/json:
            schema:
              $ref: "../../common/schemas/errors.yaml#/ErrorResponse"
    operationId: getDigitalSignatureImage

/api/digital-signatures/{id}/validate:
  post:
    tags:
      - digital-signatures
    summary: Валідувати підпис
    description: Перевіряє валідність цифрового підпису
    parameters:
      - $ref: "../../common/parameters/path.yaml#/IdParam"
    responses:
      200:
        description: Результат валідації
        content:
          application/json:
            schema:
              type: object
              properties:
                isValid:
                  type: boolean
                  description: Чи валідний підпис
                validationDetails:
                  type: object
                  properties:
                    signatureIntact:
                      type: boolean
                      description: Чи цілісний підпис
                    documentMatches:
                      type: boolean
                      description: Чи відповідає документу
                    notExpired:
                      type: boolean
                      description: Чи не прострочений
                    signerVerified:
                      type: boolean
                      description: Чи підтверджений підписант
      404:
        description: Підпис не знайдений
        content:
          application/json:
            schema:
              $ref: "../../common/schemas/errors.yaml#/ErrorResponse"
    operationId: validateDigitalSignature
