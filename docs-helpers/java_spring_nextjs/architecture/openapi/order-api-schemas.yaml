components:
  schemas:
    # Основні моделі для замовлень
    OrderDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        orderNumber:
          type: string
          example: "ORD-2025-00123"
        status:
          $ref: "#/components/schemas/OrderStatus"
        clientId:
          type: integer
          format: int64
        clientInfo:
          $ref: "#/components/schemas/ClientShortInfo"
        branchId:
          type: integer
          format: int64
        items:
          type: array
          items:
            $ref: "#/components/schemas/OrderItemDTO"
        totalPrice:
          type: number
          format: double
        totalPriceWithDiscount:
          type: number
          format: double
        discount:
          $ref: "#/components/schemas/DiscountInfo"
        expediteOption:
          $ref: "#/components/schemas/ExpediteOption"
        paymentMethod:
          $ref: "#/components/schemas/PaymentMethod"
        paymentStatus:
          type: string
          enum:
            - NOT_PAID
            - PARTIALLY_PAID
            - PAID
        receivingDate:
          type: string
          format: date-time
        completionDate:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        createdBy:
          type: string
        updatedBy:
          type: string
        notes:
          type: string
      required:
        - id
        - orderNumber
        - status
        - clientId
        - branchId
        - totalPrice
        - createdAt
        - createdBy

    CreateOrderRequest:
      type: object
      properties:
        clientId:
          type: integer
          format: int64
          description: Ідентифікатор клієнта
        branchId:
          type: integer
          format: int64
          description: Ідентифікатор філії
        items:
          type: array
          items:
            $ref: "#/components/schemas/CreateOrderItemRequest"
          description: Предмети замовлення
        discount:
          $ref: "#/components/schemas/DiscountRequest"
          description: Інформація про знижку
        expediteOption:
          $ref: "#/components/schemas/ExpediteOption"
          description: Опція терміновості
        paymentMethod:
          $ref: "#/components/schemas/PaymentMethod"
          description: Спосіб оплати
        receivingDate:
          type: string
          format: date-time
          description: Дата отримання
        notes:
          type: string
          description: Нотатки до замовлення
      required:
        - clientId
        - branchId
        - items

    UpdateOrderRequest:
      type: object
      properties:
        status:
          $ref: "#/components/schemas/OrderStatus"
          description: Новий статус замовлення
        items:
          type: array
          items:
            $ref: "#/components/schemas/UpdateOrderItemRequest"
          description: Оновлений список предметів
        discount:
          $ref: "#/components/schemas/DiscountRequest"
          description: Оновлена інформація про знижку
        expediteOption:
          $ref: "#/components/schemas/ExpediteOption"
          description: Оновлена опція терміновості
        paymentMethod:
          $ref: "#/components/schemas/PaymentMethod"
          description: Оновлений спосіб оплати
        paymentStatus:
          type: string
          enum:
            - NOT_PAID
            - PARTIALLY_PAID
            - PAID
          description: Статус оплати
        receivingDate:
          type: string
          format: date-time
          description: Оновлена дата отримання
        completionDate:
          type: string
          format: date-time
          description: Дата завершення
        notes:
          type: string
          description: Оновлені нотатки до замовлення

    OrderSearchRequest:
      type: object
      properties:
        orderNumber:
          type: string
          description: Номер замовлення для пошуку
        clientPhone:
          type: string
          description: Номер телефону клієнта для пошуку
        clientLastName:
          type: string
          description: Прізвище клієнта для пошуку
        status:
          $ref: "#/components/schemas/OrderStatus"
          description: Статус замовлення для фільтрації
        branchId:
          type: integer
          format: int64
          description: Ідентифікатор філії для фільтрації
        dateFrom:
          type: string
          format: date
          description: Дата створення (від)
        dateTo:
          type: string
          format: date
          description: Дата створення (до)
        page:
          type: integer
          default: 0
          description: Номер сторінки
        size:
          type: integer
          default: 20
          description: Розмір сторінки
        sort:
          type: string
          description: Поле та напрямок сортування (наприклад, createdAt,desc)

    # Моделі для предметів замовлення
    OrderItemDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        orderId:
          type: integer
          format: int64
        itemTypeId:
          type: integer
          format: int64
        itemTypeName:
          type: string
        categoryId:
          type: integer
          format: int64
        categoryName:
          type: string
        quantity:
          type: integer
          minimum: 1
          default: 1
        basePrice:
          type: number
          format: double
        finalPrice:
          type: number
          format: double
        appliedModifiers:
          type: array
          items:
            $ref: "#/components/schemas/PriceModifierDTO"
        defects:
          type: array
          items:
            $ref: "#/components/schemas/DefectDTO"
        photos:
          type: array
          items:
            $ref: "#/components/schemas/PhotoDTO"
        color:
          type: string
        material:
          type: string
        brand:
          type: string
        notes:
          type: string
      required:
        - id
        - orderId
        - itemTypeId
        - quantity
        - basePrice
        - finalPrice

    CreateOrderItemRequest:
      type: object
      properties:
        itemTypeId:
          type: integer
          format: int64
          description: Ідентифікатор типу предмета
        quantity:
          type: integer
          minimum: 1
          default: 1
          description: Кількість
        modifiers:
          type: array
          items:
            $ref: "#/components/schemas/ItemModifierRequest"
          description: Модифікатори ціни
        defects:
          type: array
          items:
            $ref: "#/components/schemas/CreateDefectRequest"
          description: Виявлені дефекти
        photos:
          type: array
          items:
            $ref: "#/components/schemas/CreatePhotoRequest"
          description: Фотографії предмета
        color:
          type: string
          description: Колір предмета
        material:
          type: string
          description: Матеріал предмета
        brand:
          type: string
          description: Бренд
        notes:
          type: string
          description: Додаткові нотатки
      required:
        - itemTypeId
        - quantity

    UpdateOrderItemRequest:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: Ідентифікатор предмета замовлення
        quantity:
          type: integer
          minimum: 1
          description: Оновлена кількість
        modifiers:
          type: array
          items:
            $ref: "#/components/schemas/ItemModifierRequest"
          description: Оновлений список модифікаторів ціни
        defects:
          type: array
          items:
            $ref: "#/components/schemas/UpdateDefectRequest"
          description: Оновлений список дефектів
        photos:
          type: array
          items:
            $ref: "#/components/schemas/UpdatePhotoRequest"
          description: Оновлений список фотографій
        color:
          type: string
          description: Оновлений колір
        material:
          type: string
          description: Оновлений матеріал
        brand:
          type: string
          description: Оновлений бренд
        notes:
          type: string
          description: Оновлені нотатки
      required:
        - id

    # Допоміжні моделі
    ClientShortInfo:
      type: object
      properties:
        id:
          type: integer
          format: int64
        firstName:
          type: string
        lastName:
          type: string
        phone:
          type: string
        email:
          type: string
      required:
        - id
        - firstName
        - lastName
        - phone

    DiscountInfo:
      type: object
      properties:
        type:
          $ref: "#/components/schemas/DiscountType"
        value:
          type: number
          format: double
          description: Значення знижки у відсотках
        code:
          type: string
          description: Код знижки, якщо застосовується
      required:
        - type
        - value
    
    DiscountRequest:
      type: object
      properties:
        type:
          $ref: "#/components/schemas/DiscountType"
        value:
          type: number
          format: double
          description: Значення знижки у відсотках
        code:
          type: string
          description: Код знижки, якщо застосовується
      required:
        - type
        - value

    PriceModifierDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        type:
          type: string
          enum:
            - PERCENTAGE
            - FIXED
            - COLOR
            - FIXED_QUANTITY
            - RANGE_PERCENTAGE
        value:
          type: number
          format: double
        appliedValue:
          type: number
          format: double
          description: Фактично застосована сума модифікатора
      required:
        - id
        - name
        - type
        - value
        - appliedValue

    ItemModifierRequest:
      type: object
      properties:
        modifierId:
          type: integer
          format: int64
        value:
          type: number
          format: double
      required:
        - modifierId

    DefectDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        defectTypeId:
          type: integer
          format: int64
        defectTypeName:
          type: string
        description:
          type: string
        riskLevel:
          type: string
          enum:
            - LOW
            - MEDIUM
            - HIGH
        location:
          type: string
        photoIds:
          type: array
          items:
            type: integer
            format: int64
      required:
        - id
        - defectTypeId
        - defectTypeName
        - riskLevel

    CreateDefectRequest:
      type: object
      properties:
        defectTypeId:
          type: integer
          format: int64
        description:
          type: string
        riskLevel:
          type: string
          enum:
            - LOW
            - MEDIUM
            - HIGH
        location:
          type: string
        photoReferences:
          type: array
          items:
            type: string
            description: Тимчасові ідентифікатори фотографій
      required:
        - defectTypeId
        - riskLevel

    UpdateDefectRequest:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: Ідентифікатор дефекту для оновлення
        description:
          type: string
        riskLevel:
          type: string
          enum:
            - LOW
            - MEDIUM
            - HIGH
        location:
          type: string
        photoIds:
          type: array
          items:
            type: integer
            format: int64
      required:
        - id

    PhotoDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        url:
          type: string
        thumbnailUrl:
          type: string
        description:
          type: string
        uploadedAt:
          type: string
          format: date-time
      required:
        - id
        - url
        - uploadedAt

    CreatePhotoRequest:
      type: object
      properties:
        tempFileId:
          type: string
          description: Тимчасовий ідентифікатор завантаженої фотографії
        description:
          type: string
      required:
        - tempFileId

    UpdatePhotoRequest:
      type: object
      properties:
        id:
          type: integer
          format: int64
          description: Ідентифікатор фотографії для оновлення
        description:
          type: string
      required:
        - id

    # Пагінація
    PageOrderDTO:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/OrderDTO"
        pageable:
          type: object
          properties:
            pageNumber:
              type: integer
            pageSize:
              type: integer
            sort:
              type: object
              properties:
                empty:
                  type: boolean
                sorted:
                  type: boolean
                unsorted:
                  type: boolean
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        last:
          type: boolean
        size:
          type: integer
        number:
          type: integer
        sort:
          type: object
          properties:
            empty:
              type: boolean
            sorted:
              type: boolean
            unsorted:
              type: boolean
        numberOfElements:
          type: integer
        first:
          type: boolean
        empty:
          type: boolean
      required:
        - content
        - totalElements
        - totalPages
