# Доменна модель проекту Aksi-app

## Загальна архітектура

Проект Aksi-app (хімчистка) будується на принципах Domain-Driven Design (DDD) з чітким розмежуванням бізнес-логіки та інфраструктурного коду. Архітектура розподілена на наступні шари:

1. **Presentation Layer** - REST API контролери, згенеровані з OpenAPI специфікацій
2. **Application Layer** - сервіси додатку, оркестрація бізнес-логіки
3. **Domain Layer** - бізнес-моделі, правила та логіка домену 
4. **Infrastructure Layer** - сховища даних, зовнішні сервіси, технічна реалізація

## Структура доменів

Відповідно до бізнес-вимог OrderWizard, ми виділяємо наступні домени:

### 1. Client Domain (Клієнти)

**Відповідальність:** управління даними клієнтів, пошук, створення та оновлення клієнтської інформації.

**Основні сутності:**
- Client - основна сутність клієнта з персональними даними
- ContactMethod - доступні способи зв'язку з клієнтом
- ClientSource - джерело інформації про хімчистку

**Бізнес-правила:**
- Обов'язкові поля для клієнта: прізвище, ім'я, телефон
- Унікальність телефону клієнта
- Валідація формату email та телефону

### 2. Order Domain (Замовлення)

**Відповідальність:** управління життєвим циклом замовлення, від створення до видачі.

**Основні сутності:**
- Order - головна сутність замовлення
- OrderItem - предмет у замовленні (агрегація з Item Domain)
- OrderStatus - статуси замовлення (прийнято, у роботі, готово, видано)
- ExecutionParameters - параметри виконання (терміновість)

**Бізнес-правила:**
- Замовлення має містити хоча б один предмет
- Автоматичне присвоєння номера замовлення та квитанції
- Розрахунок дати виконання на основі предметів та терміновості
- Правила застосування знижок для різних типів послуг

### 3. Item Domain (Предмети)

**Відповідальність:** управління предметами в замовленні, їх характеристиками та дефектами.

**Основні сутності:**
- Item - предмет з його характеристиками
- ItemCategory - категорія предмета (чистка одягу, прання, тощо)
- ItemType - тип предмета в межах категорії
- Material - матеріал
- Color - колір
- Filler - наповнювач (для відповідних предметів)
- WearDegree - ступінь зносу
- Stain - плями та забруднення
- Defect - дефекти та ризики

**Бізнес-правила:**
- Залежності між категорією та доступними типами предметів
- Залежності між категорією та доступними матеріалами
- Обмеження на кількість фотографій (до 5 шт, до 5MB)

### 4. Pricing Domain (Ціноутворення)

**Відповідальність:** розрахунок вартості послуг з урахуванням всіх модифікаторів.

**Основні сутності:**
- PriceList - прайс-лист з базовими цінами
- PriceModifier - модифікатор ціни (відсотковий, фіксований)
- PriceCalculation - розрахунок вартості
- Discount - знижки для замовлення

**Бізнес-правила:**
- Алгоритм застосування модифікаторів у певній послідовності
- Правила застосування знижок для різних категорій послуг
- Розрахунок націнки за терміновість
- Обмеження на комбінування знижок

### 5. Document Domain (Документи)

**Відповідальність:** генерація квитанцій та інших документів.

**Основні сутності:**
- Receipt - квитанція замовлення
- ClientSignature - цифровий підпис клієнта
- DocumentTemplate - шаблони документів

**Бізнес-правила:**
- Структура квитанції відповідно до вимог
- Підтримка друку та PDF-експорту

### 6. Branch Domain (Філії)

**Відповідальність:** управління філіями та пунктами прийому.

**Основні сутності:**
- Branch - філія компанії
- WorkingHours - графік роботи
- Employee - співробітник філії

**Бізнес-правила:**
- Валідація доступності філії для приймання/видачі замовлень
- Визначення оператора, який прийняв замовлення

## Зв'язки між доменами

1. **Order → Client**: Замовлення посилається на клієнта
2. **Order → Branch**: Замовлення містить філію приймання
3. **Order → OrderItem → Item**: Замовлення містить колекцію предметів
4. **OrderItem → Pricing**: Предмет замовлення використовує ціноутворення для розрахунку вартості
5. **Order → Document**: Замовлення генерує документи (квитанції)

## Висновки

Запропонована доменна модель забезпечує:
- Чіткий розподіл відповідальності між доменами
- Виділення ключових бізнес-сутностей та правил
- Гнучкість для розширення функціональності
- Можливість ізольованого тестування кожного домену
- Відповідність принципам DDD для складної бізнес-логіки

У наступних документах буде детально описано кожен домен окремо з OpenAPI специфікаціями та технічними деталями реалізації.
