openapi: 3.0.3
info:
  title: Order Domain API
  description: API для управління замовленнями в односторінковій системі хімчистки
  version: 1.0.0
  contact:
    name: AKSI Development Team
    email: dev@aksi.com

servers:
  - url: http://localhost:8080
    description: Development server
  - url: https://api.aksi.com
    description: Production server

tags:
  - name: orders
    description: Управління замовленнями
  - name: order-items
    description: Управління предметами замовлення
  - name: order-calculations
    description: Розрахунки та калькулятор
  - name: order-completion
    description: Завершення замовлення

paths:
  /api/orders:
    get:
      tags: [orders]
      summary: Отримати список замовлень
      description: Повертає список замовлень з можливістю фільтрації та пагінації
      parameters:
        - name: page
          in: query
          description: Номер сторінки (починаючи з 0)
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: size
          in: query
          description: Розмір сторінки
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          description: Фільтр за статусом замовлення
          required: false
          schema:
            $ref: "#/components/schemas/OrderStatus"
        - name: branchId
          in: query
          description: Фільтр за філією
          required: false
          schema:
            type: string
            format: uuid
        - name: clientId
          in: query
          description: Фільтр за клієнтом
          required: false
          schema:
            type: string
            format: uuid
        - name: dateFrom
          in: query
          description: Дата створення (від)
          required: false
          schema:
            type: string
            format: date
        - name: dateTo
          in: query
          description: Дата створення (до)
          required: false
          schema:
            type: string
            format: date
      responses:
        "200":
          description: Список замовлень
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderPageResponse"
        "400":
          description: Некоректні параметри запиту
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    post:
      tags: [orders]
      summary: Створити нове замовлення
      description: Створює нове замовлення для односторінкової системи
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrderRequest"
      responses:
        "201":
          description: Замовлення успішно створене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderResponse"
        "400":
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"

  /api/orders/{id}:
    get:
      tags: [orders]
      summary: Отримати замовлення за ID
      description: Повертає детальну інформацію про замовлення
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Інформація про замовлення
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    put:
      tags: [orders]
      summary: Оновити замовлення
      description: Оновлює існуюче замовлення
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateOrderRequest"
      responses:
        "200":
          description: Замовлення успішно оновлене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderResponse"
        "400":
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    delete:
      tags: [orders]
      summary: Скасувати замовлення
      description: Скасовує замовлення (м'яке видалення)
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Замовлення успішно скасоване
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/orders/{id}/items:
    get:
      tags: [order-items]
      summary: Отримати предмети замовлення
      description: Повертає список всіх предметів в замовленні
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Список предметів замовлення
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrderItemResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    post:
      tags: [order-items]
      summary: Додати предмет до замовлення
      description: Додає новий предмет до замовлення з повним розрахунком ціни
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrderItemRequest"
      responses:
        "201":
          description: Предмет успішно додано
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderItemResponse"
        "400":
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/orders/{orderId}/items/{itemId}:
    get:
      tags: [order-items]
      summary: Отримати конкретний предмет замовлення
      description: Повертає детальну інформацію про предмет
      parameters:
        - name: orderId
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
        - name: itemId
          in: path
          required: true
          description: Унікальний ідентифікатор предмета (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Інформація про предмет
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderItemResponse"
        "404":
          description: Предмет або замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    put:
      tags: [order-items]
      summary: Оновити предмет замовлення
      description: Оновлює існуючий предмет з перерахунком ціни
      parameters:
        - name: orderId
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
        - name: itemId
          in: path
          required: true
          description: Унікальний ідентифікатор предмета (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateOrderItemRequest"
      responses:
        "200":
          description: Предмет успішно оновлений
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderItemResponse"
        "400":
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"
        "404":
          description: Предмет або замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    delete:
      tags: [order-items]
      summary: Видалити предмет з замовлення
      description: Видаляє предмет з замовлення та перераховує загальну суму
      parameters:
        - name: orderId
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
        - name: itemId
          in: path
          required: true
          description: Унікальний ідентифікатор предмета (UUID)
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Предмет успішно видалений
        "404":
          description: Предмет або замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/orders/{id}/calculate:
    post:
      tags: [order-calculations]
      summary: Розрахувати вартість замовлення
      description: Перераховує загальну вартість замовлення з усіма модифікаторами та знижками
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CalculateOrderRequest"
      responses:
        "200":
          description: Розрахунок завершений
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderCalculationResponse"
        "400":
          description: Помилка валідації параметрів розрахунку
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/orders/{id}/calculate/preview:
    post:
      tags: [order-calculations]
      summary: Попередній розрахунок вартості
      description: Розраховує вартість без збереження змін (для інтерактивного калькулятора)
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CalculateOrderRequest"
      responses:
        "200":
          description: Попередній розрахунок
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderCalculationResponse"
        "400":
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"

  /api/orders/{id}/payment:
    put:
      tags: [orders]
      summary: Оновити інформацію про оплату
      description: Оновлює спосіб оплати та суму передоплати
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePaymentRequest"
      responses:
        "200":
          description: Інформація про оплату оновлена
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderResponse"
        "400":
          description: Помилка валідації
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/orders/{id}/complete:
    post:
      tags: [order-completion]
      summary: Завершити замовлення
      description: Завершує замовлення з цифровим підписом клієнта та генерацією квитанції
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CompleteOrderRequest"
      responses:
        "200":
          description: Замовлення успішно завершене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CompletedOrderResponse"
        "400":
          description: Помилка валідації або незавершені обов'язкові поля
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ValidationErrorResponse"
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/orders/{id}/receipt:
    get:
      tags: [order-completion]
      summary: Отримати квитанцію замовлення
      description: Генерує та повертає квитанцію у форматі PDF
      parameters:
        - name: id
          in: path
          required: true
          description: Унікальний ідентифікатор замовлення (UUID)
          schema:
            type: string
            format: uuid
        - name: format
          in: query
          description: Формат квитанції
          required: false
          schema:
            type: string
            enum: [PDF, HTML]
            default: PDF
      responses:
        "200":
          description: Квитанція згенерована
          content:
            application/pdf:
              schema:
                type: string
                format: binary
            text/html:
              schema:
                type: string
        "404":
          description: Замовлення не знайдене
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

components:
  schemas:
    # Request Schemas
    CreateOrderRequest:
      type: object
      required:
        - clientId
        - branchId
        - uniqueTag
      properties:
        clientId:
          type: string
          format: uuid
          description: Ідентифікатор клієнта
        branchId:
          type: string
          format: uuid
          description: Ідентифікатор філії прийому
        uniqueTag:
          type: string
          minLength: 1
          maxLength: 50
          description: Унікальна мітка замовлення
          example: "TAG-2025-001"
        notes:
          type: string
          maxLength: 1000
          description: Примітки до замовлення
        urgency:
          $ref: "#/components/schemas/UrgencyType"
          description: Терміновість виконання
          default: NORMAL

    UpdateOrderRequest:
      type: object
      properties:
        uniqueTag:
          type: string
          minLength: 1
          maxLength: 50
          description: Унікальна мітка замовлення
        executionDate:
          type: string
          format: date-time
          description: Дата виконання замовлення
        urgency:
          $ref: "#/components/schemas/UrgencyType"
        discount:
          $ref: "#/components/schemas/DiscountRequest"
        notes:
          type: string
          maxLength: 1000
          description: Примітки до замовлення

    CreateOrderItemRequest:
      type: object
      required:
        - itemName
        - category
        - quantity
        - unit
        - material
        - color
      properties:
        itemName:
          type: string
          minLength: 1
          maxLength: 100
          description: Найменування предмета
          example: "Костюм чоловічий"
        category:
          type: string
          description: Категорія послуги
          enum:
            - TEXTILE_CLEANING
            - LAUNDRY
            - IRONING
            - LEATHER_CLEANING
            - SHEEPSKIN
            - FUR
            - DYEING
        quantity:
          type: integer
          minimum: 1
          description: Кількість
        unit:
          type: string
          enum: [PIECE, KILOGRAM]
          description: Одиниця виміру
        material:
          type: string
          maxLength: 50
          description: Матеріал виробу
          example: "Шерсть"
        color:
          type: string
          maxLength: 50
          description: Колір виробу
          example: "Чорний"
        filling:
          type: string
          maxLength: 50
          description: Наповнювач (якщо є)
          example: "Пух"
        wearDegree:
          type: integer
          minimum: 10
          maximum: 75
          description: Ступінь зносу у відсотках
          example: 30
        stains:
          type: array
          items:
            type: string
            enum:
              - FAT
              - BLOOD
              - PROTEIN
              - WINE
              - COFFEE
              - GRASS
              - INK
              - COSMETICS
              - OTHER
          description: Типи плям
        defects:
          type: array
          items:
            type: string
            enum:
              - WEAR
              - TORN
              - MISSING_HARDWARE
              - DAMAGED_HARDWARE
              - COLOR_CHANGE_RISK
              - DEFORMATION_RISK
              - NO_WARRANTY
          description: Дефекти та ризики
        defectNotes:
          type: string
          maxLength: 500
          description: Примітки щодо дефектів
        modifiers:
          type: array
          items:
            $ref: "#/components/schemas/PriceModifierRequest"
          description: Застосовані модифікатори ціни
        photos:
          type: array
          items:
            type: string
            format: uri
          maxItems: 5
          description: URL фотографій предмета

    UpdateOrderItemRequest:
      type: object
      properties:
        itemName:
          type: string
          minLength: 1
          maxLength: 100
          description: Найменування предмета
        quantity:
          type: integer
          minimum: 1
          description: Кількість
        material:
          type: string
          maxLength: 50
          description: Матеріал виробу
        color:
          type: string
          maxLength: 50
          description: Колір виробу
        filling:
          type: string
          maxLength: 50
          description: Наповнювач
        wearDegree:
          type: integer
          minimum: 10
          maximum: 75
          description: Ступінь зносу у відсотках
        stains:
          type: array
          items:
            type: string
            enum:
              - FAT
              - BLOOD
              - PROTEIN
              - WINE
              - COFFEE
              - GRASS
              - INK
              - COSMETICS
              - OTHER
        defects:
          type: array
          items:
            type: string
            enum:
              - WEAR
              - TORN
              - MISSING_HARDWARE
              - DAMAGED_HARDWARE
              - COLOR_CHANGE_RISK
              - DEFORMATION_RISK
              - NO_WARRANTY
        defectNotes:
          type: string
          maxLength: 500
          description: Примітки щодо дефектів
        modifiers:
          type: array
          items:
            $ref: "#/components/schemas/PriceModifierRequest"
        photos:
          type: array
          items:
            type: string
            format: uri
          maxItems: 5

    CalculateOrderRequest:
      type: object
      properties:
        urgency:
          $ref: "#/components/schemas/UrgencyType"
          description: Терміновість виконання
        discount:
          $ref: "#/components/schemas/DiscountRequest"
          description: Знижка на замовлення
        recalculateItems:
          type: boolean
          default: true
          description: Чи перераховувати ціни предметів

    UpdatePaymentRequest:
      type: object
      required:
        - paymentMethod
        - paidAmount
      properties:
        paymentMethod:
          $ref: "#/components/schemas/PaymentMethod"
        paidAmount:
          type: number
          format: decimal
          minimum: 0
          description: Сума передоплати
          example: 500.00

    CompleteOrderRequest:
      type: object
      required:
        - clientSignature
        - legalAcceptance
      properties:
        clientSignature:
          type: string
          description: Цифровий підпис клієнта (base64)
        legalAcceptance:
          type: boolean
          description: Згода з умовами надання послуг
          example: true
        operatorName:
          type: string
          maxLength: 100
          description: Ім'я оператора
        finalNotes:
          type: string
          maxLength: 500
          description: Фінальні примітки

    DiscountRequest:
      type: object
      required:
        - type
      properties:
        type:
          $ref: "#/components/schemas/DiscountType"
        customPercentage:
          type: number
          format: decimal
          minimum: 0
          maximum: 100
          description: Кастомний відсоток знижки (для типу OTHER)
        description:
          type: string
          maxLength: 200
          description: Опис знижки

    PriceModifierRequest:
      type: object
      required:
        - name
        - type
        - value
      properties:
        name:
          type: string
          maxLength: 100
          description: Назва модифікатора
        type:
          $ref: "#/components/schemas/ModifierType"
        value:
          type: number
          format: decimal
          description: Значення модифікатора

    # Response Schemas
    OrderResponse:
      type: object
      required:
        - id
        - receiptNumber
        - uniqueTag
        - clientId
        - branchId
        - status
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор замовлення
        receiptNumber:
          type: string
          description: Номер квитанції
          example: "AKSI-2025-000123"
        uniqueTag:
          type: string
          description: Унікальна мітка замовлення
        clientId:
          type: string
          format: uuid
          description: Ідентифікатор клієнта
        clientInfo:
          $ref: "#/components/schemas/ClientSummary"
        branchId:
          type: string
          format: uuid
          description: Ідентифікатор філії
        branchInfo:
          $ref: "#/components/schemas/BranchSummary"
        status:
          $ref: "#/components/schemas/OrderStatus"
        items:
          type: array
          items:
            $ref: "#/components/schemas/OrderItemResponse"
        calculation:
          $ref: "#/components/schemas/OrderCalculationSummary"
        urgency:
          $ref: "#/components/schemas/UrgencyType"
        executionDate:
          type: string
          format: date-time
          description: Дата виконання замовлення
        discount:
          $ref: "#/components/schemas/DiscountInfo"
        payment:
          $ref: "#/components/schemas/PaymentInfo"
        notes:
          type: string
          description: Примітки до замовлення
        clientSignature:
          type: string
          description: Цифровий підпис клієнта (base64)
        operatorName:
          type: string
          description: Ім'я оператора
        createdAt:
          type: string
          format: date-time
          description: Дата створення
        updatedAt:
          type: string
          format: date-time
          description: Дата останнього оновлення

    OrderItemResponse:
      type: object
      required:
        - id
        - itemName
        - category
        - quantity
        - unit
        - material
        - color
        - basePrice
        - finalPrice
      properties:
        id:
          type: string
          format: uuid
          description: Унікальний ідентифікатор предмета
        itemName:
          type: string
          description: Найменування предмета
        category:
          type: string
          description: Категорія послуги
        quantity:
          type: integer
          description: Кількість
        unit:
          type: string
          enum: [PIECE, KILOGRAM]
          description: Одиниця виміру
        material:
          type: string
          description: Матеріал виробу
        color:
          type: string
          description: Колір виробу
        filling:
          type: string
          description: Наповнювач
        wearDegree:
          type: integer
          description: Ступінь зносу у відсотках
        stains:
          type: array
          items:
            type: string
          description: Типи плям
        defects:
          type: array
          items:
            type: string
          description: Дефекти та ризики
        defectNotes:
          type: string
          description: Примітки щодо дефектів
        basePrice:
          type: number
          format: decimal
          description: Базова ціна
        modifiers:
          type: array
          items:
            $ref: "#/components/schemas/AppliedModifier"
          description: Застосовані модифікатори
        finalPrice:
          type: number
          format: decimal
          description: Фінальна ціна за предмет
        calculation:
          $ref: "#/components/schemas/ItemCalculationDetails"
        photos:
          type: array
          items:
            type: string
            format: uri
          description: URL фотографій предмета

    OrderCalculationResponse:
      type: object
      properties:
        orderId:
          type: string
          format: uuid
        itemsTotal:
          type: number
          format: decimal
          description: Сума за всі предмети
        urgencyCharge:
          type: number
          format: decimal
          description: Надбавка за терміновість
        subtotal:
          type: number
          format: decimal
          description: Проміжна сума
        discountAmount:
          type: number
          format: decimal
          description: Сума знижки
        totalAmount:
          type: number
          format: decimal
          description: Загальна сума до сплати
        itemCalculations:
          type: array
          items:
            $ref: "#/components/schemas/ItemCalculationDetails"
          description: Детальні розрахунки по кожному предмету
        discountWarnings:
          type: array
          items:
            type: string
          description: Попередження про неприйнятні знижки

    CompletedOrderResponse:
      type: object
      properties:
        orderId:
          type: string
          format: uuid
        receiptNumber:
          type: string
        status:
          $ref: "#/components/schemas/OrderStatus"
        receiptUrl:
          type: string
          format: uri
          description: URL для завантаження квитанції
        qrCode:
          type: string
          description: QR-код для відстеження замовлення
        completedAt:
          type: string
          format: date-time

    OrderPageResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/OrderResponse"
        pageable:
          $ref: "#/components/schemas/PageableInfo"
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        last:
          type: boolean
        first:
          type: boolean
        numberOfElements:
          type: integer

    # Value Objects
    ClientSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        phone:
          type: string
        email:
          type: string

    BranchSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        code:
          type: string
        name:
          type: string
        address:
          type: string

    OrderCalculationSummary:
      type: object
      properties:
        itemsTotal:
          type: number
          format: decimal
        urgencyCharge:
          type: number
          format: decimal
        discountAmount:
          type: number
          format: decimal
        totalAmount:
          type: number
          format: decimal

    DiscountInfo:
      type: object
      properties:
        type:
          $ref: "#/components/schemas/DiscountType"
        percentage:
          type: number
          format: decimal
        amount:
          type: number
          format: decimal
        description:
          type: string

    PaymentInfo:
      type: object
      properties:
        method:
          $ref: "#/components/schemas/PaymentMethod"
        totalAmount:
          type: number
          format: decimal
        paidAmount:
          type: number
          format: decimal
        debtAmount:
          type: number
          format: decimal

    AppliedModifier:
      type: object
      properties:
        name:
          type: string
        type:
          $ref: "#/components/schemas/ModifierType"
        value:
          type: number
          format: decimal
        appliedAmount:
          type: number
          format: decimal

    ItemCalculationDetails:
      type: object
      properties:
        itemId:
          type: string
          format: uuid
        basePrice:
          type: number
          format: decimal
        modifiersTotal:
          type: number
          format: decimal
        subtotal:
          type: number
          format: decimal
        urgencyCharge:
          type: number
          format: decimal
        discountAmount:
          type: number
          format: decimal
        finalPrice:
          type: number
          format: decimal
        calculationSteps:
          type: array
          items:
            $ref: "#/components/schemas/CalculationStep"

    CalculationStep:
      type: object
      properties:
        step:
          type: string
          description: Назва кроку розрахунку
        description:
          type: string
          description: Опис кроку
        amount:
          type: number
          format: decimal
          description: Сума на цьому кроці
        runningTotal:
          type: number
          format: decimal
          description: Накопичена сума

    PageableInfo:
      type: object
      properties:
        page:
          type: integer
        size:
          type: integer
        sort:
          type: array
          items:
            type: string

    # Enums
    OrderStatus:
      type: string
      enum:
        - DRAFT
        - CREATED
        - IN_PROGRESS
        - READY
        - COMPLETED
        - CANCELLED
      description: |
        Статуси замовлення:
        * DRAFT - Чернетка
        * CREATED - Створено
        * IN_PROGRESS - В роботі
        * READY - Готово
        * COMPLETED - Завершено
        * CANCELLED - Скасовано

    UrgencyType:
      type: string
      enum:
        - NORMAL
        - URGENT_48H
        - URGENT_24H
      description: |
        Терміновість виконання:
        * NORMAL - Звичайне (без надбавки)
        * URGENT_48H - Термінове 48 год (+50%)
        * URGENT_24H - Термінове 24 год (+100%)

    DiscountType:
      type: string
      enum:
        - NONE
        - EVERCARD
        - SOCIAL_MEDIA
        - MILITARY
        - OTHER
      description: |
        Типи знижок:
        * NONE - Без знижки
        * EVERCARD - Еверкард (10%)
        * SOCIAL_MEDIA - Соцмережі (5%)
        * MILITARY - ЗСУ (10%)
        * OTHER - Інше (кастомний відсоток)

    PaymentMethod:
      type: string
      enum:
        - TERMINAL
        - CASH
        - BANK_ACCOUNT
      description: |
        Способи оплати:
        * TERMINAL - Термінал
        * CASH - Готівка
        * BANK_ACCOUNT - На рахунок

    ModifierType:
      type: string
      enum:
        - PERCENTAGE
        - FIXED
        - MULTIPLIER
      description: |
        Типи модифікаторів ціни:
        * PERCENTAGE - Відсотковий
        * FIXED - Фіксована сума
        * MULTIPLIER - Множник

    # Error Schemas
    ErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string

    ValidationErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string
        validationErrors:
          type: array
          items:
            $ref: "#/components/schemas/FieldError"

    FieldError:
      type: object
      properties:
        field:
          type: string
        message:
          type: string
        rejectedValue:
          description: Значення, яке було відхилено
        code:
          type: string

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
